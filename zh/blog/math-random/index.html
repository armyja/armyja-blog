<!DOCTYPE html><html lang="zh" class="scroll-smooth"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><title>Math.random()</title><meta name="robots" content="follow, index"/><meta name="description" content="唐纳德·克努特曾在《计算机程序设计的艺术》（卷二）中指出：“当今使用的大部分随机数生成器都不够优秀，而且开发者倾向于拿来就用，不去了解具体的生成策略。以至于我们常常发现一些略有瑕疵、年代久远的随机数生成器会被盲目地用在一个又一个的程序中，而对于它们的局限性，却无人问津。”"/><meta property="og:url" content="https://armyja.cn/zh/blog/math-random/"/><meta property="og:type" content="article"/><meta property="og:site_name" content="如若不燃"/><meta property="og:description" content="唐纳德·克努特曾在《计算机程序设计的艺术》（卷二）中指出：“当今使用的大部分随机数生成器都不够优秀，而且开发者倾向于拿来就用，不去了解具体的生成策略。以至于我们常常发现一些略有瑕疵、年代久远的随机数生成器会被盲目地用在一个又一个的程序中，而对于它们的局限性，却无人问津。”"/><meta property="og:title" content="Math.random()"/><meta property="og:image" content="https://armyja.cn/static/images/twitter-card.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/Twitter"/><meta name="twitter:title" content="Math.random()"/><meta name="twitter:description" content="唐纳德·克努特曾在《计算机程序设计的艺术》（卷二）中指出：“当今使用的大部分随机数生成器都不够优秀，而且开发者倾向于拿来就用，不去了解具体的生成策略。以至于我们常常发现一些略有瑕疵、年代久远的随机数生成器会被盲目地用在一个又一个的程序中，而对于它们的局限性，却无人问津。”"/><meta name="twitter:image" content="https://armyja.cn/static/images/twitter-card.png"/><link rel="canonical" href="https://armyja.cn/zh/blog/math-random/"/><meta property="article:published_time" content="2016-05-02T14:42:54.000Z"/><meta property="article:modified_time" content="2018-03-10T01:01:17.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://armyja.cn/blog/math-random"
  },
  "headline": "Math.random()",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://armyja.cn/static/images/twitter-card.png"
    }
  ],
  "datePublished": "2016-05-02T14:42:54.000Z",
  "dateModified": "2018-03-10T01:01:17.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jeffrey Wang"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "Jeffrey Wang",
    "logo": {
      "@type": "ImageObject",
      "url": "https://armyja.cn/static/images/logo.png"
    }
  },
  "description": "唐纳德·克努特曾在《计算机程序设计的艺术》（卷二）中指出：“当今使用的大部分随机数生成器都不够优秀，而且开发者倾向于拿来就用，不去了解具体的生成策略。以至于我们常常发现一些略有瑕疵、年代久远的随机数生成器会被盲目地用在一个又一个的程序中，而对于它们的局限性，却无人问津。”"
}</script><meta name="next-head-count" content="20"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/manifest.json"/><meta name="mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="application-name" content="如若不燃"/><meta name="apple-mobile-web-app-title" content="如若不燃"/><meta name="msapplication-tooltip" content="如若不燃"/><meta name="theme-color" content="#FFFFFF"/><meta name="msapplication-navbutton-color" content="#FFFFFF"/><meta name="msapplication-starturl" content="/"/><link rel="preload" href="/_next/static/css/7c22d30f60c141bf.css" as="style"/><link rel="stylesheet" href="/_next/static/css/7c22d30f60c141bf.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="data:text/javascript;base64,IWZ1bmN0aW9uKCl7dHJ5IHt2YXIgZD1kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0O2QucmVtb3ZlKCdsaWdodCcsJ2RhcmsnKTt2YXIgZT1sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndGhlbWUnKTtpZigic3lzdGVtIj09PWV8fCghZSYmdHJ1ZSkpe3ZhciB0PSIocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspIixtPXdpbmRvdy5tYXRjaE1lZGlhKHQpO2lmKG0ubWVkaWEhPT10fHxtLm1hdGNoZXMpe2Quc3R5bGUuY29sb3JTY2hlbWUgPSAnZGFyayc7ZC5hZGQoJ2RhcmsnKX1lbHNle2Quc3R5bGUuY29sb3JTY2hlbWUgPSAnbGlnaHQnO2QuYWRkKCdsaWdodCcpfX1lbHNlIGlmKGUpe2QuYWRkKGV8fCAnJyl9aWYoZT09PSdsaWdodCd8fGU9PT0nZGFyaycpZC5zdHlsZS5jb2xvclNjaGVtZT1lfWNhdGNoKGUpe319KCk=" id="next-themes-script" defer="" data-nscript="beforeInteractive"></script><script src="/_next/static/chunks/webpack-b08446f8ffcdd46b.js" defer=""></script><script src="/_next/static/chunks/framework-fc97f3f1282ce3ed.js" defer=""></script><script src="/_next/static/chunks/main-ee5d5a2fd99a0519.js" defer=""></script><script src="/_next/static/chunks/pages/_app-075a31ccc190937f.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/497-64cebf56b328d93d.js" defer=""></script><script src="/_next/static/chunks/152-e8dcfcf1aa489cb1.js" defer=""></script><script src="/_next/static/chunks/789-4bedb49ad2151a02.js" defer=""></script><script src="/_next/static/chunks/354-54b3786a957b78ae.js" defer=""></script><script src="/_next/static/chunks/253-c252016aa4ff4683.js" defer=""></script><script src="/_next/static/chunks/pages/%5Blocale%5D/blog/%5B...slug%5D-07e0f170ef57bf1b.js" defer=""></script><script src="/_next/static/ttnszolnmKQYjpK0XVIq0/_buildManifest.js" defer=""></script><script src="/_next/static/ttnszolnmKQYjpK0XVIq0/_ssgManifest.js" defer=""></script><script src="/_next/static/ttnszolnmKQYjpK0XVIq0/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next"><div class="h-screen"><header class="fixed z-10 flex w-full items-center justify-between bg-white/80 px-4 py-3 shadow-md shadow-black/5 backdrop-blur-sm dark:bg-gray-900/80 dark:shadow-slate-400/5"><div class="overflow-hidden"><div class="h-8 transition-transform "><a aria-label="Armyja" href="/"><div class="flex"><div class="relative mt-1 h-7 w-8"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 180 180" style="height:100%;width:100%;position:absolute;left:0;top:0"><g transform="matrix(1.7 0 0 1.7 4.6 16)"><defs><linearGradient x1="0" y1="0" x2="0" y2="1" id="logo_svg__a" gradientTransform="rotate(-150 .5 .5)"><stop offset="0" stop-color="#57dae6"></stop><stop offset="1" stop-color="#576de6"></stop></linearGradient></defs><path fill="url(#logo_svg__a)" d="m50 10 19.4 33.55 4.4-2.35L50 0 0 86.55h100L78.8 49.9l-4.4 2.3 16.95 29.35H8.7L50 10Z"></path></g><path fill="#ff9393" d="M4.6 163.39h81.005l-40.46-70.21L4.6 163.39m66.215-8.585H19.39l25.755-44.625 25.67 44.625Z"></path></svg></div><div class="mb-1 ml-2 hidden text-2xl font-medium sm:block">Armyja</div></div></a><div class="my-6 text-2xl font-medium sm:my-5" style="display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden"></div></div></div><div class="z-0 flex shrink-0 items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium uppercase text-gray-900 dark:text-gray-100 sm:p-4" href="/tags/">标签</a><a class="p-1 font-medium uppercase text-gray-900 dark:text-gray-100 sm:p-4" href="/about/">关于</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-16 right-0 z-10 h-screen w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed h-full w-full cursor-auto focus:outline-none"></button><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags/">标签</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about/">关于</a></div></nav></div></div></div></header><div class="mx-auto h-full max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex min-h-full flex-col justify-between pt-16"><main class="mb-auto"><div class="fixed right-8 bottom-8 flex-col gap-3 transition-transform scale-0"><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2016-05-02T14:42:54.000Z">2016年5月2日星期一</time></dd></div></dl><div><h1 class="text-3xl font-bold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10">Math.random()</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0" style="grid-template-rows:auto 1fr"><dl class="py-4 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2738%27%20height=%2738%27/%3e"/></span><img alt="avatar" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="h-10 w-10 rounded-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="avatar" srcSet="/static/images/avatar.jpg?imwidth=48 1x, /static/images/avatar.jpg?imwidth=96 2x" src="/static/images/avatar.jpg?imwidth=96" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="h-10 w-10 rounded-full" loading="lazy"/></noscript></span><dl class="whitespace-nowrap text-sm font-medium leading-5"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Jeffrey Wang</dd><dt class="sr-only">Twitter</dt><dd></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><p>唐纳德·克努特曾在《计算机程序设计的艺术》（卷二）中指出：“当今使用的大部分随机数生成器都不够优秀，而且开发者倾向于拿来就用，不去了解具体的生成策略。以至于我们常常发现一些略有瑕疵、年代久远的随机数生成器会被盲目地用在一个又一个的程序中，而对于它们的局限性，却无人问津。”</p><p>我希望在读过本文之后能够让大家对以下两件事深表认同，虽然其中一件尚存在争议：</p><ul><li>我们不应该忽视 V8 PRNG（pseudo-random number generator）的局限性，至少应该了解更安全的 CSPRNG（Cryptographically Secure Pseudo-Random Number Generator）</li><li>当前 V8 引擎中的 <!-- --><code>Math.random()</code> 存在问题<!-- --></li></ul><p>Betable（作者所在的公司）的业务非常依赖随机数，最常见的需求就是生成一个随机标识符，而且对这标识符有一个严格的要求：不允许生成同一个标识符两次，也就是杜绝碰撞。</p><p>但事实上影响碰撞效果的因素只有两个：</p><ul><li>标识符的总量，即有多少种可能性</li><li>标识符的生成策略</li></ul><p>为了避免基于生日悖论（<!-- --><a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Birthday_problem">birthday paradox</a>）的攻击，我们生成的标识符由 <!-- --><code>64</code> 种字符（数字、大小写字母以及 <!-- --><code>-</code> 和 <!-- --><code>_</code> ）组成 <!-- --><code>22</code> 位字符串，比如 <!-- --><code>EB5iGydiUL0h4bRu1ZyRIi</code> 和 <!-- --><code>HV2ZKGVJJklN0eH35IgNaB</code>。也就是说标识符总共存在 2^132 种可能性，如果每秒会生成一百万个标识符，那么在未来三百年内发生碰撞的几率只有六十亿分之一。<!-- --></p><p>有了足够的标识符之后，我们就要考虑标识符的生成策略。传统方式是使用伪随机数字生成器（PRNG），这一生成器也是许多标准库的选择。因为我们的很多服务是基于 Node.js 构建的，所以会用到 V8 引擎中的 <!-- --><code>Math.random()</code>，该函数返回一个 <!-- --><code>[0, 1)</code> 之间的数字。<!-- --></p><div class="relative"><pre><code class="language-javascript code-highlight"><span class="code-line"><span class="token keyword">var</span> <!-- --><span class="token constant">ALPHABET</span> <!-- --><span class="token operator">=</span> <!-- --><span class="token string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_&#x27;</span>
<!-- --></span><span class="code-line">
</span><span class="code-line"><span class="token function function-variable">random_base64</span> <!-- --><span class="token operator">=</span> <!-- --><span class="token keyword">function</span> <!-- --><span class="token function">random_base64</span><span class="token punctuation">(</span><span class="token parameter">length</span><span class="token punctuation">)</span> <!-- --><span class="token punctuation">{</span>
<!-- --></span><span class="code-line">  <!-- --><span class="token keyword">var</span> str <!-- --><span class="token operator">=</span> <!-- --><span class="token string">&#x27;&#x27;</span>
<!-- --></span><span class="code-line">  <!-- --><span class="token keyword control-flow">for</span> <!-- --><span class="token punctuation">(</span><span class="token keyword">var</span> i <!-- --><span class="token operator">=</span> <!-- --><span class="token number">0</span><span class="token punctuation">;</span> i <!-- --><span class="token operator">&lt;</span> length<!-- --><span class="token punctuation">;</span> <!-- --><span class="token operator">++</span>i<!-- --><span class="token punctuation">)</span> <!-- --><span class="token punctuation">{</span>
<!-- --></span><span class="code-line">    <!-- --><span class="token keyword">var</span> rand <!-- --><span class="token operator">=</span> <!-- --><span class="token class-name known-class-name">Math</span><span class="token punctuation">.</span><span class="token function property-access method">floor</span><span class="token punctuation">(</span><span class="token class-name known-class-name">Math</span><span class="token punctuation">.</span><span class="token function property-access method">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <!-- --><span class="token operator">*</span> <!-- --><span class="token constant">ALPHABET</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">)</span>
<!-- --></span><span class="code-line">    str <!-- --><span class="token operator">+=</span> <!-- --><span class="token constant">ALPHABET</span><span class="token punctuation">.</span><span class="token function property-access method">substring</span><span class="token punctuation">(</span>rand<!-- --><span class="token punctuation">,</span> rand <!-- --><span class="token operator">+</span> <!-- --><span class="token number">1</span><span class="token punctuation">)</span>
<!-- --></span><span class="code-line">  <!-- --><span class="token punctuation">}</span>
<!-- --></span><span class="code-line">  <!-- --><span class="token keyword control-flow">return</span> str
<!-- --></span><span class="code-line"><span class="token punctuation">}</span>
<!-- --></span></code></pre></div><p>在上面的代码中我们创建了一个包含所有字符的序列，然后基于 <!-- --><code>Math.random()</code> 的返回值从中随机选取字符，最终拼接成长为 <!-- --><code>length</code> 的标识符字符串。<!-- --></p><p>这一生成策略看起来很完美，直到有一天我们收到了 <!-- --><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/forte_nick">Nick Forte</a> 的邮件，他在邮件中声称它接收到了两个相同的标识符。这让我们意识到其中必有蹊跷。John von Neumann 曾经毫不留情地指责：“开发者对使用算法生成随机数的自负和执迷不悟，是一切的原罪。”简而言之，确定性的方法无法真实地创造随机性，比如数理运算。这道理听起来矛盾重重似是而非……<!-- --></p><p><img alt="" src="http://cdn2.w3cplus.com/cdn/farfuture/bfbv1ozSPL_vXz2KytLcs783LNsZuMrrSVYg6JvBBmo/mtime:1462031115/sites/default/files/blogs/2016/1604/math-random-6.png"/></p><h2 id="prng"><a href="#prng" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>PRNG<!-- --></h2><p>从下图演示的随机数生成流程中可以清晰看出，<!-- --><a target="_blank" rel="noopener noreferrer" href="https://gist.github.com/mmalone/6ef9fabe1a7540ae89e8">PRNG 算法</a>生成的并不是随机数，而是一种伪随机。对于大多数的使用场景，伪随机的做法并没有错，重点是这种伪随机要足够以假乱真。在伪随机性之外，下图还揭示了另一个问题：周期性循环。虽然周期长短都无法保证伪随机的质量，但长周期显然要好于短周期，如果我们知道周期的存在但无法计算这一周期长度时，那么就可以将其周期上限视为小于等于随机数的数量，这也是一个优秀的 PRNG 算法应具有的特点。<!-- --></p><p><img alt="PRNG" src="http://cdn2.w3cplus.com/cdn/farfuture/5mGck9m08jvih5dKSKum-gGeEizNsHrbhDl59dEWR1A/mtime:1462030402/sites/default/files/blogs/2016/1604/math-random-1.png"/></p><p>接下来，让我们深入分析一下 PRNG 生成的随机序列所存在的缺陷。举例来说，我们需要使用 PRNG 处理 <!-- --><code>[0, 15]</code> 十六个整数生成类似 <!-- --><code>(2, 13, 4)</code> 和 <!-- --><code>(5, 12, 15)</code> 之类的元组，理论上说应该有 16^3 种可能性，但简单的 PRNG 只会生成少量的非重复结果（这里是 <!-- --><code>16</code> 种）：<!-- --></p><p><img alt="PRNG" src="http://cdn2.w3cplus.com/cdn/farfuture/F6Uth8mGRRaMvXLOp5Jnq1cb5Pp0n44kc1bFY9Ro2Sw/mtime:1462030401/sites/default/files/blogs/2016/1604/math-random-2.png"/></p><p>还记得本文最初提到的随机标识符吗？生成标识符的原理就和生成上面的元组一样，最终能够生成的非重复结果就取决于 PRNG 的内部状态和循环周期。</p><h2 id="mathrandom"><a href="#mathrandom" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Math.random()<!-- --></h2><p>对于 Nick 在邮件中提到的问题，我们迅速审查了相关的代码逻辑，但并没有找到任何缺陷，这说明问题涉及的技术层面可能会非常深。<!-- --><a target="_blank" rel="noopener noreferrer" href="http://www.ecma-international.org/ecma-262/6.0/#sec-math.random">ECMAScript 规范</a>是这样描述 <!-- --><code>Math.random()</code> 的：“返回一个整数，该整数的取值范围大于等于 <!-- --><code>0</code> 而小于 <!-- --><code>1</code>，浏览器开发商使用自定义的算法或策略从该范围内实现均匀分布的随机或伪随机效果。”<!-- --></p><p>显然，规范中遗漏了大量的细节。首先，它没有定义精度。由于 ECMAScript 使用 IEEE 754 双精度浮点数存储所有数值，所以理论上应该有 <!-- --><code>53</code> 位的精确度，即随机数的随机范围是 <!-- --><code>[1/x^53, 2^53-1]</code>，但实际上，V8 中的 <!-- --><code>Math.random()</code> 只有 <!-- --><code>32</code> 位精度，不过这已经足够我们用的了。<!-- --></p><p>真正的问题是规范放任浏览器开发者自由实现该方法，且没有限制最小的周期长度，唯一对分布的要求也只是“近似均匀”。</p><h2 id="v8-prng"><a href="#v8-prng" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>V8 PRNG<!-- --></h2><div class="relative"><pre><code class="language-javascript code-highlight"><span class="code-line"><span class="token keyword">var</span> <!-- --><span class="token constant">MAX_RAND</span> <!-- --><span class="token operator">=</span> <!-- --><span class="token class-name known-class-name">Math</span><span class="token punctuation">.</span><span class="token function property-access method">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <!-- --><span class="token number">32</span><span class="token punctuation">)</span>
<!-- --></span><span class="code-line"><span class="token keyword">var</span> state <!-- --><span class="token operator">=</span> <!-- --><span class="token punctuation">[</span><span class="token function">seed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <!-- --><span class="token function">seed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<!-- --></span><span class="code-line">
</span><span class="code-line"><span class="token keyword">var</span> <!-- --><span class="token function function-variable">mwc1616</span> <!-- --><span class="token operator">=</span> <!-- --><span class="token keyword">function</span> <!-- --><span class="token function">mwc1616</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <!-- --><span class="token punctuation">{</span>
<!-- --></span><span class="code-line">  <!-- --><span class="token keyword">var</span> r0 <!-- --><span class="token operator">=</span> <!-- --><span class="token punctuation">(</span><span class="token number">18030</span> <!-- --><span class="token operator">*</span> <!-- --><span class="token punctuation">(</span>state<!-- --><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <!-- --><span class="token operator">&amp;</span> <!-- --><span class="token number">0xffff</span><span class="token punctuation">)</span> <!-- --><span class="token operator">+</span> <!-- --><span class="token punctuation">(</span>state<!-- --><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <!-- --><span class="token operator">&gt;&gt;&gt;</span> <!-- --><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <!-- --><span class="token operator">|</span> <!-- --><span class="token number">0</span>
<!-- --></span><span class="code-line">  <!-- --><span class="token keyword">var</span> r1 <!-- --><span class="token operator">=</span> <!-- --><span class="token punctuation">(</span><span class="token number">36969</span> <!-- --><span class="token operator">*</span> <!-- --><span class="token punctuation">(</span>state<!-- --><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <!-- --><span class="token operator">&amp;</span> <!-- --><span class="token number">0xffff</span><span class="token punctuation">)</span> <!-- --><span class="token operator">+</span> <!-- --><span class="token punctuation">(</span>state<!-- --><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <!-- --><span class="token operator">&gt;&gt;&gt;</span> <!-- --><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <!-- --><span class="token operator">|</span> <!-- --><span class="token number">0</span>
<!-- --></span><span class="code-line">  state <!-- --><span class="token operator">=</span> <!-- --><span class="token punctuation">[</span>r0<!-- --><span class="token punctuation">,</span> r1<!-- --><span class="token punctuation">]</span>
<!-- --></span><span class="code-line">
</span><span class="code-line">  <!-- --><span class="token keyword">var</span> x <!-- --><span class="token operator">=</span> <!-- --><span class="token punctuation">(</span><span class="token punctuation">(</span>r0 <!-- --><span class="token operator">&lt;&lt;</span> <!-- --><span class="token number">16</span><span class="token punctuation">)</span> <!-- --><span class="token operator">+</span> <!-- --><span class="token punctuation">(</span>r1 <!-- --><span class="token operator">&amp;</span> <!-- --><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <!-- --><span class="token operator">|</span> <!-- --><span class="token number">0</span>
<!-- --></span><span class="code-line">  <!-- --><span class="token keyword control-flow">if</span> <!-- --><span class="token punctuation">(</span>x <!-- --><span class="token operator">&lt;</span> <!-- --><span class="token number">0</span><span class="token punctuation">)</span> <!-- --><span class="token punctuation">{</span>
<!-- --></span><span class="code-line">    x <!-- --><span class="token operator">=</span> x <!-- --><span class="token operator">+</span> <!-- --><span class="token constant">MAX_RAND</span>
<!-- --></span><span class="code-line">  <!-- --><span class="token punctuation">}</span>
<!-- --></span><span class="code-line">  <!-- --><span class="token keyword control-flow">return</span> x <!-- --><span class="token operator">/</span> <!-- --><span class="token constant">MAX_RAND</span>
<!-- --></span><span class="code-line"><span class="token punctuation">}</span>
<!-- --></span></code></pre></div><p>上述代码就是 V8 PRNG 的核心逻辑。在老版本的 V8 源码中对此有一段注释：“随机数生成器使用了 George Marsaglia 的 MWC 算法。”根据这段注释，我从谷歌搜索到了以下信息：</p><ul><li><a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/George_Marsaglia">George Marsaglia</a> 是一个毕生致力于 PRNG 的数学家，他还开发了用于测试随机数生成质量的工具 <!-- --><a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Diehard_tests">Diehard tests</a></li><li>MWC（<!-- --><a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Multiply-with-carry">multiply-with-carry</a>）是由 <!-- --><a target="_blank" rel="noopener noreferrer" href="http://digitalcommons.wayne.edu/cgi/viewcontent.cgi?article=1725&amp;context=jmasm">Marsaglia</a> 发明的 PRNG 算法，非常类似于 <!-- --><a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Linear_congruential_generator">LCG</a>（linear congruential generators，线性同余法），其优势在于生成的循环周期更长，接近于 CPU 的循环周期。<!-- --></li></ul><p>不过，V8 PRNG 与经典的 MWC 生成器并不相同，因为它不是对 MWC 生成器的简单扩展，而是组合使用了两个 MWC 子生成器（<!-- --><code>r0</code> 和 <!-- --><code>r1</code>），并最终拼接成一个随机数。这里略过相关的数学计算，只说结论，每个子生成器最长的循环周期长度都是 2^30，合并后为 2^60。<!-- --></p><p>上文提到过，我们定义的标识符有 2^132 种可能性，所以 V8 的 <!-- --><code>Math.random()</code> 并不能满足这一需求。尽管如此，我们仍使用该函数并假设生成的随机数是均匀分布的，那么生成一亿个标识符后出现碰撞的可能性才只有 <!-- --><code>0.4%</code>，但现在发生碰撞的时间也太早了，所以我们的分析一定有什么地方出错了。之前已经证明循环周期长度是正确的，那么很有可能生成的随机数不是均匀分布的，一定有其他的结构影响了生成的序列。<!-- --></p><h2 id="双子生成器"><a href="#双子生成器" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>双子生成器<!-- --></h2><div class="relative"><pre><code class="language-javascript code-highlight"><span class="code-line"><span class="token keyword">var</span> <!-- --><span class="token constant">ALPHABET</span> <!-- --><span class="token operator">=</span> <!-- --><span class="token string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_&#x27;</span>
<!-- --></span><span class="code-line">
</span><span class="code-line"><span class="token function function-variable">random_base64</span> <!-- --><span class="token operator">=</span> <!-- --><span class="token keyword">function</span> <!-- --><span class="token function">random_base64</span><span class="token punctuation">(</span><span class="token parameter">length</span><span class="token punctuation">)</span> <!-- --><span class="token punctuation">{</span>
<!-- --></span><span class="code-line">  <!-- --><span class="token keyword">var</span> str <!-- --><span class="token operator">=</span> <!-- --><span class="token string">&#x27;&#x27;</span>
<!-- --></span><span class="code-line">  <!-- --><span class="token keyword control-flow">for</span> <!-- --><span class="token punctuation">(</span><span class="token keyword">var</span> i <!-- --><span class="token operator">=</span> <!-- --><span class="token number">0</span><span class="token punctuation">;</span> i <!-- --><span class="token operator">&lt;</span> length<!-- --><span class="token punctuation">;</span> <!-- --><span class="token operator">++</span>i<!-- --><span class="token punctuation">)</span> <!-- --><span class="token punctuation">{</span>
<!-- --></span><span class="code-line">    <!-- --><span class="token comment">// Math.random(): ((r0 &lt;&lt; 16) + (r1 &amp; 0xFFFF)) | 0</span>
<!-- --></span><span class="code-line">    <!-- --><span class="token keyword">var</span> rand <!-- --><span class="token operator">=</span> <!-- --><span class="token class-name known-class-name">Math</span><span class="token punctuation">.</span><span class="token function property-access method">floor</span><span class="token punctuation">(</span><span class="token class-name known-class-name">Math</span><span class="token punctuation">.</span><span class="token function property-access method">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <!-- --><span class="token operator">*</span> <!-- --><span class="token constant">ALPHABET</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">)</span>
<!-- --></span><span class="code-line">    str <!-- --><span class="token operator">+=</span> <!-- --><span class="token constant">ALPHABET</span><span class="token punctuation">.</span><span class="token function property-access method">substring</span><span class="token punctuation">(</span>rand<!-- --><span class="token punctuation">,</span> rand <!-- --><span class="token operator">+</span> <!-- --><span class="token number">1</span><span class="token punctuation">)</span>
<!-- --></span><span class="code-line">  <!-- --><span class="token punctuation">}</span>
<!-- --></span><span class="code-line">  <!-- --><span class="token keyword control-flow">return</span> str
<!-- --></span><span class="code-line"><span class="token punctuation">}</span>
<!-- --></span></code></pre></div><p>上面代码中的 <!-- --><code>Math.floor(Math.random() * ALPHABET.length)</code> 一句非常重要，它被用来扩大随机数的范围并取整，同时它也会让最终的随机数丢失低字节，倾向于高字节。究其原因，是因为 V8 的算法在合并两个子生成器的结果时，使用的不是异或计算，而是简单粗暴的拼接。这是非常严重的缺陷。当我们将 <!-- --><code>Math.random()</code> 的范围扩展到 <!-- --><code>[0, 64]</code> 并取整后，就已经改变了它的平衡性，更多的倾向于使用高位字节。这些高位字节通常来自于 MWC 子生成器中的第一个生成器。<!-- --></p><p><img alt="双子生成器" src="http://cdn2.w3cplus.com/cdn/farfuture/qPSPvklNkAJ_kiisudbrAGZihfbB0Jqhecd8kAEOjIg/mtime:1462030404/sites/default/files/blogs/2016/1604/math-random-3.png"/></p><p>如果单独分析一下第一个子生成器，就会发现它具有 <!-- --><code>32</code> 位的内部状态，实际的循环周期长度是 <!-- --><code>5.9</code> 亿左右（<!-- --><code>18030*2^15</code>，计算细节请参考文末资料），所以使用这个生成器只能生成 <!-- --><code>5.9</code> 亿标识符，也就是生成 <!-- --><code>30000</code> 个标识符后就有超过 <!-- --><code>50%</code> 的概率发生碰撞。<!-- --></p><p>但如果这是真的话，那么在生成标识符之后不久就会发生碰撞。为了理解这一现象，想想我们之前生成元组的示例，在这个示例中也没发生生日悖论，这是因为这个序列根本不是随机的，所以不能假装它是。V8 PRNG 和我们的随机标识符也是同样的道理，在特定条件下，PRNG 的伪随机性反倒不易生成碰撞。</p><p><img alt="双子生成器" src="http://cdn1.w3cplus.com/cdn/farfuture/mYUDjnNzT142NJPAzNnZnFZAUPhUcSgB29-H0UXjgm4/mtime:1462030402/sites/default/files/blogs/2016/1604/math-random-4.png"/></p><p>虽然在这种场景下生成器对我们的需求有益，但既然存在错误，我们就应该寻求更高质量的 PRNG，一个有效的方式就是让生成器的循环周期长度远大于随机数的可能性。这里有一个启发式的方法：如果需要生成具有 <!-- --><code>n</code> 中可能性的随机数，那么就需要一个循环周期长度为 <!-- --><code>n^2</code> 的 PRNG（相关细节请参考 Pierre L&#x27;Ecuyer 的 <!-- --><a target="_blank" rel="noopener noreferrer" href="http://www.iro.umontreal.ca/~lecuyer/myftp/papers/handstat.pdf">random number generation</a>）。<!-- --></p><p>对于我们所遇到的问题，可以说是过于关注序列的重叠度，而忽视统计随机性了。如果一个生成器要生成 <!-- --><code>n</code> 个长度为 <!-- --><code>l</code> 的序列，且循环周期长度为 <!-- --><code>p</code>，那么其重叠概率就是 <!-- --><code>[1-(nl)/(p-1)]^(n-1)</code>，或当 <!-- --><code>p</code> 足够大时接近 <!-- --><code>ln^2/p</code>（相关细节请参考文末资料）。这告诉我们需要一个相当大的循环周期，否则序列的随机性就会变得脆弱。<!-- --></p><p>简而言之，如果你正在使用 V8 的 <!-- --><code>Math.random()</code> 生成随机数序列，那么为了保证随机性，序列长度应该小于 <!-- --><code>24000</code>；如果想避免碰撞，那么应该选择其他的方法生成随机序列。<!-- --></p><h2 id="mwc1616"><a href="#mwc1616" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>MWC1616<!-- --></h2><p>Marsaglia 在 1997 年提出了 MWC1616，他认为该方法可以通过所有的随机性测试。不幸的是，他在九十年代末使用的 Diehard tests 并不符合今天的标准。如果使用更加现代的测试框架测试，就会发现该算法在当时问题百出。</p><div class="relative"><pre><code class="language-javascript code-highlight"><span class="code-line"><span class="token comment">// January 12, 1999 / V8 PRNG: ((r0 &lt;&lt; 16) + (r1 ^ 0xFFFF)) % 2^32</span>
<!-- --></span><span class="code-line"><span class="token keyword">var</span> x <!-- --><span class="token operator">=</span> <!-- --><span class="token punctuation">(</span><span class="token punctuation">(</span>r0 <!-- --><span class="token operator">&lt;&lt;</span> <!-- --><span class="token number">16</span><span class="token punctuation">)</span> <!-- --><span class="token operator">+</span> <!-- --><span class="token punctuation">(</span>r1 <!-- --><span class="token operator">&amp;</span> <!-- --><span class="token number">0xffff</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <!-- --><span class="token operator">|</span> <!-- --><span class="token number">0</span>
<!-- --></span><span class="code-line">
</span><span class="code-line"><span class="token comment">// January 20, 1999: (r0 &lt;&lt; 16) + r1) % 2^32</span>
<!-- --></span><span class="code-line"><span class="token keyword">var</span> x <!-- --><span class="token operator">=</span> <!-- --><span class="token punctuation">(</span><span class="token punctuation">(</span>r0 <!-- --><span class="token operator">&lt;&lt;</span> <!-- --><span class="token number">16</span><span class="token punctuation">)</span> <!-- --><span class="token operator">+</span> r1<!-- --><span class="token punctuation">)</span> <!-- --><span class="token operator">|</span> <!-- --><span class="token number">0</span>
<!-- --></span></code></pre></div><p>就我所知，拼接子生成器的结果创造随机数并没有什么数学方面的依据，最常见的都是使用模运算进行合并。Marsaglia 在 Usenet 发布了 MWC1616 之后也意识到了这个问题，所以在 1999 年 1 月 12 日又发布了如今被 V8 所有的 MVC1616 版本。八天之后，他又发表了另一个不同的版本。新版本对于两个子生成器的合并更加均衡。</p><p>这两个版本的 MWC1616 都被其他程序引用了，所以就出现了误解。1 月 20 日的 MWC1616 的基数被标记为 <!-- --><code>b = 2^16</code>，且被注释为仅限用于 <!-- --><code>32</code> 位的算术。当你使用该版本的时候，会被警告替换该算法，但实际上它比 V8 <!-- --><code>Math.random()</code> 中适用的 MWC 要好。此外更令人不解的是，1 月 20 日的 MWC1616 被维基百科作为随机数生成的示例演示，而 TestU01 中包含了两种 1 月 12 日 MWC1616 的实现，一个是 MWC1616，一个是 MWC97R。<!-- --></p><p>希望这篇文章可以提醒开发者，并强化 Knuth 的观察结果：</p><ul><li>通常来说，PRNG 存在瑕疵，开发者应该具体情况具体分析，理解这些算法的局限性</li><li>特别的，不要使用 MWC1616，它并不够好</li></ul><h2 id="csprng"><a href="#csprng" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>CSPRNG<!-- --></h2><p>为了修复我们的标识符生成器，需要一种解析速度快、可替代 Math.random() 的方法。虽然有很多 JavaScript 的 PRNG 实现可用，但我们主要针对以下几点查找这一方法：</p><ul><li>循环周期长，远大于标识符的 <!-- --><code>2^132</code> 种可能性<!-- --></li><li>有良好的支持且经得起测试</li></ul><p>幸运的是，Node.js 的标准库提供了另一个 PRNG 就满足这两点要求：<!-- --><code>crypto.randomBytes()</code>，一个密码学安全伪随机数生成器（CSPRNG）。如果是在浏览器上，也可以使用 <!-- --><code>crypto.getRandomValues()</code> 实现。<!-- --></p><p>但这并不是完美的通用解决方案，有以下三个原因：</p><ul><li>CSPRNG 通常是非线性变换，慢于非密码的解决方案</li><li>许多 CSPRNG 系统不支持种子状态，进而使得序列结果不可复现</li><li>CSPRNG 强调不可预测性重于质量</li></ul><p>不过：</p><ul><li>速度是相对的，CSPRNG 对大多数使用场景来说都是很快的</li><li>对于不可预测，这也让我们无法区分真正的随机性，也就是我们想要的伪随机性序列</li><li>以“安全加密”为主打的生成器往往代码审查更严格且随机性测试更全面</li></ul><p>如果你无法信任非加密方案的质量，或者除非使用既定的收发方案保证质量，使用 CSPRNG 都是你最好的选择。如果你不信任标准库中的 CSPRNG，那么可以使用由 kenel 维护的 <!-- --><a target="_blank" rel="noopener noreferrer" href="http://sockpuppet.org/blog/2014/02/25/safely-generate-random-numbers/">urandom</a>。<!-- --></p><p>我无法告诉你 <!-- --><code>crypto.randomBytes()</code> 的确切循环周期，是因为还没人遇到过这一问题，我只能说它很安全。如果你相信 OpenSSL 生成的公钥和私钥的安全性，那么就没有理由不相信它。在实际开发中，使用 <!-- --><code>crypto.randomBytes()</code> 可以轻松解决 <!-- --><code>Math.random()</code> 的问题。<!-- --></p><p>实际上，Chrome 也可以令 Math.random() 调用 crypto.randomBytes() 中使用的 CSPRNG，详见 <!-- --><a target="_blank" rel="noopener noreferrer" href="http://trac.webkit.org/browser/trunk/Source/WTF/wtf/RandomNumber.cpp#L41">what Webkit is doing</a>。也即是说，有很多安全且高质量的非加密方案。<!-- --></p><h2 id="v8s-prng"><a href="#v8s-prng" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>V8&#x27;s PRNG<!-- --></h2><p>我的目标是说服你 V8 的 Math.random() 有瑕疵且应该被替换。到目前为止我们已经发现它规律性的输出、在测试上的失败以及真实环境的低性能等问题。如果你期待更多的证据，那就看以下图片吧（译者注：以下图片演示的问题可能已被修复）：</p><p><img alt="V8&#x27;s PRNG" src="http://cdn2.w3cplus.com/cdn/farfuture/CcaG3IAyqC6mqWDZHZCj55rRvXRS176oIx-ix8o3vO0/mtime:1462030355/sites/default/files/blogs/2016/1604/20160428-math-random-csprng.png"/></p><p>此时你应该认可 V8 中的 <!-- --><code>Math.random()</code> 存在缺陷且应该被修复了吧。那么问题来了，我们应该如何修复它呢？虽然修复很简单，但是继续使用 MWC 显然是无意义的，我们有更好的选择。<!-- --></p><p>下面列出了我们对随机数生成器的要求：</p><ul><li>随机数空间大，种子状态多——理想情况下，要大于 <!-- --><code>1024</code> 位，因为这是其他生成器保证质量的上限。对于 <!-- --><code>2^1024</code> 种可能性，足以满足 99.9% 的需求了，且具有强大的安全性<!-- --></li><li>速度至少要和当前的实现保持一致</li><li>高效的内存使用率</li><li>循环周期药厂，任何大于 <!-- --><code>2^50</code> 周期长度的生成器都是可用的，大于 <!-- --><code>2^100</code> 则可让伪随机性以假乱真<!-- --></li><li>经得起随机性测试</li></ul><p>当前有许多 PRNG 算法满足或远超上述要求。<!-- --><a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Xorshift">Xorshift</a> 速度快且耐得住严格的统计测试。xorgens4096 是 xorshift 的变体，基于 JavaScript 开发实现，它有 4096 位状态空间，循环周期长达 2^4096，并且比 Chrome 中的 MWC16 运行速度更快。此外，它能够无系统故障地通过 BigCrush 的测试。<!-- --></p><p>最近的实践表明，使用 xorshift 生成的结果乘以常量的结果也可以通过 BigCrush 对非线性转换生成器的测试。此类生成器被称为 <!-- --><code>xorshift\*</code>，它们解析速度快、易于时间且内存使用效率高，其中 <!-- --><code>xorshift102\*</code>就满足甚至超过以上的全部要求。如果内存占用问题严重，也可以使用 <!-- --><code>xorshift64\*</code>，它比 MWC1616 的内存占用率相同，但循环周期更长、解析更快。另一个线性和非线性的混合生成器是 PCG，它声称具有和 <!-- --><code>xorshift\*</code> 具有相似的性能和质量。<!-- --></p><p>所以说我们有许多可选择的算法，其中，最安全的选择也许就是标准的 Mersenne Twiste（马特赛特旋转演算法）。该算法最受欢迎的变体 MT19937 诞生于九十年代末，从那时开始它就成为了许多软件标准的随机数生成策略。它并不是完美的，但久经考验和分析，且易于理解。值得炫耀的是，它的循环周期长达 <!-- --><code>2^19937-1</code>，基本上不会发生碰撞，但使用该算法会强制要求 2KB 的状态空间和相应的内存占用、性能消耗。虽然无法解释，但它和 Chrome 中 <!-- --><code>Math.random()</code> 的执行速度一样快。<!-- --></p><p>所以我的建议就是 V8 应该考虑一下 Dean McNamee 六年前的建议，使用马特赛特旋转演算法实现 <!-- --><code>Math.random()</code> 了。它解析速度快、健壮且安全，对不了解 PRNG 运行机制的开发者也是安全无害的。当然也可以选择其他方案，但请不要再使用 MWC1616 了！<!-- --></p><h2 id="总结"><a href="#总结" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>总结<!-- --></h2><p>本文也是够长的，我们总结一下：</p><ul><li>V8 中的 <!-- --><code>Math.random()</code> 使用的 PRNG 算法是 MWC1616。如果你只使用 <!-- --><code>16</code> 位，那么它的循环周期长度就会很短。通常来说，它在质量测试中的表现很差，对于大多数的重要场景，它所伪造的随机性是不安全的。<!-- --></li><li>如果你没时间实现非加密的方案，那就直接使用 CSPRNG 吧。最安全的的方式就是使用 <!-- --><a target="_blank" rel="noopener noreferrer" href="http://sockpuppet.org/blog/2014/02/25/safely-generate-random-numbers/">urandom</a>。在浏览器环境中，可以使用 <!-- --><code>crypto.getRandomValues()</code>。<!-- --></li><li>也有许多比 MWC1616 速度更快、质量更高的非加密 PRNG 算法。V8 应该使用它们重新实现 <!-- --><code>Math.random()</code>。Mersenne Twiste 可以说是最受欢迎的方案了，有可能也是最安全的方案。<!-- --></li></ul><p>注意，Mozilla 中使用了来自 Java 的 util.Random 包，且略差于 MWC1616，所以 SpiderMonkey 也应该升级相关方法。</p><h3 id="参考资料"><a href="#参考资料" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>参考资料<!-- --></h3><ul><li><a target="_blank" rel="noopener noreferrer" href="http://digitalcommons.wayne.edu/cgi/viewcontent.cgi?article=1725&amp;context=jmasm">Random Number Generators</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Multiply-with-carry#General_theory">Multiply-with-carry</a></li><li><a target="_blank" rel="noopener noreferrer" href="http://xorshift.di.unimi.it/">:::xoroshiro+ / xorshift* / xorshift+ generators and the PRNG shootout</a></li><li><a target="_blank" rel="noopener noreferrer" href="http://www.mathpages.com/home/kmath580/kmath580.htm">Probability of Intersecting Intervals</a></li></ul><blockquote><p>本文根据<!-- --><a target="_blank" rel="noopener noreferrer" href="https://medium.com/@betable">@Betable Engineering</a>的《<!-- --><a target="_blank" rel="noopener noreferrer" href="https://medium.com/@betable/tifu-by-using-math-random-f1c308c4fd9d#.si669u680">TIFU by using Math.random()</a>》所译，整个译文带有我们自己的理解与思想，如果译得不好或有不对之处还请同行朋友指点。如需转载此译文，需注明英文出处：<!-- --><a target="_blank" rel="noopener noreferrer" href="https://medium.com/@betable/tifu-by-using-math-random-f1c308c4fd9d#.si669u680">https://medium.com/@betable/tifu-by-using-math-random-f1c308c4fd9d#.si669u680</a>。<!-- --></p><p>原文出处：<!-- --><a target="_blank" rel="noopener noreferrer" href="http://www.w3cplus.com/javascript/tifu-by-using-math-random.html">http://www.w3cplus.com/javascript/tifu-by-using-math-random.html</a></p></blockquote></div><div class="pt-6 pb-6 text-sm text-gray-700 dark:text-gray-300"><a target="_blank" rel="noopener noreferrer" href="https://github.com/armyja/blog/blob/master/data/blog/math-random.md">在 GitHub 查看</a></div></div><footer><div class="divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y"><div class="py-4 xl:py-8"><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">Tags</h2><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/tags/nodejs/">Node.js</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">上一篇文章</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/nodejszhong-exportsyu-module-exportsde-qu-bie-xiang-xi-jie-shao/">Node.js：exports 与 module.exports 的区别</a></div></div><div><h2 class="text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400">下一篇文章</h2><div class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400"><a href="/blog/dynamic-tracing/">动态追踪技术漫谈</a></div></div></div></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog/">← <!-- -->返回<!-- --></a></div></footer></div></div></article></main><footer><div class="mt-10 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:546323405@qq.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/armyja"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://weibo.com/armyja"><span class="sr-only">sinaWeibo</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M10.098 20.323c-3.977.391-7.414-1.406-7.672-4.02-.259-2.609 2.759-5.047 6.74-5.441 3.979-.394 7.413 1.404 7.671 4.018.259 2.6-2.759 5.049-6.737 5.439l-.002.004zM9.05 17.219c-.384.616-1.208.884-1.829.602-.612-.279-.793-.991-.406-1.593.379-.595 1.176-.861 1.793-.601.622.263.82.972.442 1.592zm1.27-1.627c-.141.237-.449.353-.689.253-.236-.09-.313-.361-.177-.586.138-.227.436-.346.672-.24.239.09.315.36.18.601l.014-.028zm.176-2.719c-1.893-.493-4.033.45-4.857 2.118-.836 1.704-.026 3.591 1.886 4.21 1.983.64 4.318-.341 5.132-2.179.8-1.793-.201-3.642-2.161-4.149zm7.563-1.224c-.346-.105-.57-.18-.405-.615.375-.977.42-1.804 0-2.404-.781-1.112-2.915-1.053-5.364-.03 0 0-.766.331-.571-.271.376-1.217.315-2.224-.27-2.809-1.338-1.337-4.869.045-7.888 3.08C1.309 10.87 0 13.273 0 15.348c0 3.981 5.099 6.395 10.086 6.395 6.536 0 10.888-3.801 10.888-6.82 0-1.822-1.547-2.854-2.915-3.284v.01zm1.908-5.092a3.101 3.101 0 0 0-2.96-.962.786.786 0 0 0-.616.932.79.79 0 0 0 .932.602 1.512 1.512 0 0 1 1.442.465c.376.421.466.977.316 1.473a.786.786 0 0 0 .51.992.813.813 0 0 0 .992-.512 3.108 3.108 0 0 0-.646-3.035l.03.045zm2.418-2.195c-1.576-1.757-3.905-2.419-6.054-1.968a.91.91 0 0 0-.706 1.081.91.91 0 0 0 1.082.707 4.5 4.5 0 0 1 4.296 1.383 4.533 4.533 0 0 1 .947 4.416.91.91 0 0 0 .586 1.157c.479.165.991-.104 1.157-.586a6.387 6.387 0 0 0-1.338-6.235l.03.045z"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Jeffrey Wang</div><div> • </div><div>© 2022</div><div> • </div><a href="/">如若不燃</a></div><div class="mb-8 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><a target="_blank" rel="noopener noreferrer" href="https://beian.miit.gov.cn/">粤ICP备16027191号-1</a><div> • </div><a href="/en/">en</a></div></div></footer></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var d=Object.create;var l=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var N=(a,c)=\u003e()=\u003e(c||a((c={exports:{}}).exports,c),c.exports),k=(a,c)=\u003e{for(var s in c)l(a,s,{get:c[s],enumerable:!0})},i=(a,c,s,e)=\u003e{if(c\u0026\u0026typeof c==\"object\"||typeof c==\"function\")for(let r of p(c))!u.call(a,r)\u0026\u0026r!==s\u0026\u0026l(a,r,{get:()=\u003ec[r],enumerable:!(e=h(c,r))||e.enumerable});return a};var f=(a,c,s)=\u003e(s=a!=null?d(m(a)):{},i(c||!a||!a.__esModule?l(s,\"default\",{value:a,enumerable:!0}):s,a)),g=a=\u003ei(l({},\"__esModule\",{value:!0}),a);var o=N((R,t)=\u003e{t.exports=_jsx_runtime});var M={};k(M,{default:()=\u003ey,frontmatter:()=\u003eb});var n=f(o()),b={title:\"Math.random()\",slug:\"math-random\",date_published:new Date(1462200174e3),date_updated:new Date(1520643677e3),author:\"Jeffey Wang\",tags:\"Node.js\",summary:\"\\u5510\\u7EB3\\u5FB7\\xB7\\u514B\\u52AA\\u7279\\u66FE\\u5728\\u300A\\u8BA1\\u7B97\\u673A\\u7A0B\\u5E8F\\u8BBE\\u8BA1\\u7684\\u827A\\u672F\\u300B\\uFF08\\u5377\\u4E8C\\uFF09\\u4E2D\\u6307\\u51FA\\uFF1A\\u201C\\u5F53\\u4ECA\\u4F7F\\u7528\\u7684\\u5927\\u90E8\\u5206\\u968F\\u673A\\u6570\\u751F\\u6210\\u5668\\u90FD\\u4E0D\\u591F\\u4F18\\u79C0\\uFF0C\\u800C\\u4E14\\u5F00\\u53D1\\u8005\\u503E\\u5411\\u4E8E\\u62FF\\u6765\\u5C31\\u7528\\uFF0C\\u4E0D\\u53BB\\u4E86\\u89E3\\u5177\\u4F53\\u7684\\u751F\\u6210\\u7B56\\u7565\\u3002\\u4EE5\\u81F3\\u4E8E\\u6211\\u4EEC\\u5E38\\u5E38\\u53D1\\u73B0\\u4E00\\u4E9B\\u7565\\u6709\\u7455\\u75B5\\u3001\\u5E74\\u4EE3\\u4E45\\u8FDC\\u7684\\u968F\\u673A\\u6570\\u751F\\u6210\\u5668\\u4F1A\\u88AB\\u76F2\\u76EE\\u5730\\u7528\\u5728\\u4E00\\u4E2A\\u53C8\\u4E00\\u4E2A\\u7684\\u7A0B\\u5E8F\\u4E2D\\uFF0C\\u800C\\u5BF9\\u4E8E\\u5B83\\u4EEC\\u7684\\u5C40\\u9650\\u6027\\uFF0C\\u5374\\u65E0\\u4EBA\\u95EE\\u6D25\\u3002\\u201D\"};function w(a={}){let{wrapper:c}=a.components||{};return c?(0,n.jsx)(c,Object.assign({},a,{children:(0,n.jsx)(s,{})})):s();function s(){let e=Object.assign({p:\"p\",ul:\"ul\",li:\"li\",code:\"code\",a:\"a\",pre:\"pre\",span:\"span\",img:\"img\",h2:\"h2\",h3:\"h3\",blockquote:\"blockquote\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.p,{children:\"\\u5510\\u7EB3\\u5FB7\\xB7\\u514B\\u52AA\\u7279\\u66FE\\u5728\\u300A\\u8BA1\\u7B97\\u673A\\u7A0B\\u5E8F\\u8BBE\\u8BA1\\u7684\\u827A\\u672F\\u300B\\uFF08\\u5377\\u4E8C\\uFF09\\u4E2D\\u6307\\u51FA\\uFF1A\\u201C\\u5F53\\u4ECA\\u4F7F\\u7528\\u7684\\u5927\\u90E8\\u5206\\u968F\\u673A\\u6570\\u751F\\u6210\\u5668\\u90FD\\u4E0D\\u591F\\u4F18\\u79C0\\uFF0C\\u800C\\u4E14\\u5F00\\u53D1\\u8005\\u503E\\u5411\\u4E8E\\u62FF\\u6765\\u5C31\\u7528\\uFF0C\\u4E0D\\u53BB\\u4E86\\u89E3\\u5177\\u4F53\\u7684\\u751F\\u6210\\u7B56\\u7565\\u3002\\u4EE5\\u81F3\\u4E8E\\u6211\\u4EEC\\u5E38\\u5E38\\u53D1\\u73B0\\u4E00\\u4E9B\\u7565\\u6709\\u7455\\u75B5\\u3001\\u5E74\\u4EE3\\u4E45\\u8FDC\\u7684\\u968F\\u673A\\u6570\\u751F\\u6210\\u5668\\u4F1A\\u88AB\\u76F2\\u76EE\\u5730\\u7528\\u5728\\u4E00\\u4E2A\\u53C8\\u4E00\\u4E2A\\u7684\\u7A0B\\u5E8F\\u4E2D\\uFF0C\\u800C\\u5BF9\\u4E8E\\u5B83\\u4EEC\\u7684\\u5C40\\u9650\\u6027\\uFF0C\\u5374\\u65E0\\u4EBA\\u95EE\\u6D25\\u3002\\u201D\"}),(0,n.jsx)(e.p,{children:\"\\u6211\\u5E0C\\u671B\\u5728\\u8BFB\\u8FC7\\u672C\\u6587\\u4E4B\\u540E\\u80FD\\u591F\\u8BA9\\u5927\\u5BB6\\u5BF9\\u4EE5\\u4E0B\\u4E24\\u4EF6\\u4E8B\\u6DF1\\u8868\\u8BA4\\u540C\\uFF0C\\u867D\\u7136\\u5176\\u4E2D\\u4E00\\u4EF6\\u5C1A\\u5B58\\u5728\\u4E89\\u8BAE\\uFF1A\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:\"\\u6211\\u4EEC\\u4E0D\\u5E94\\u8BE5\\u5FFD\\u89C6 V8 PRNG\\uFF08pseudo-random number generator\\uFF09\\u7684\\u5C40\\u9650\\u6027\\uFF0C\\u81F3\\u5C11\\u5E94\\u8BE5\\u4E86\\u89E3\\u66F4\\u5B89\\u5168\\u7684 CSPRNG\\uFF08Cryptographically Secure Pseudo-Random Number Generator\\uFF09\"}),(0,n.jsxs)(e.li,{children:[\"\\u5F53\\u524D V8 \\u5F15\\u64CE\\u4E2D\\u7684 \",(0,n.jsx)(e.code,{children:\"Math.random()\"}),\" \\u5B58\\u5728\\u95EE\\u9898\"]})]}),(0,n.jsx)(e.p,{children:\"Betable\\uFF08\\u4F5C\\u8005\\u6240\\u5728\\u7684\\u516C\\u53F8\\uFF09\\u7684\\u4E1A\\u52A1\\u975E\\u5E38\\u4F9D\\u8D56\\u968F\\u673A\\u6570\\uFF0C\\u6700\\u5E38\\u89C1\\u7684\\u9700\\u6C42\\u5C31\\u662F\\u751F\\u6210\\u4E00\\u4E2A\\u968F\\u673A\\u6807\\u8BC6\\u7B26\\uFF0C\\u800C\\u4E14\\u5BF9\\u8FD9\\u6807\\u8BC6\\u7B26\\u6709\\u4E00\\u4E2A\\u4E25\\u683C\\u7684\\u8981\\u6C42\\uFF1A\\u4E0D\\u5141\\u8BB8\\u751F\\u6210\\u540C\\u4E00\\u4E2A\\u6807\\u8BC6\\u7B26\\u4E24\\u6B21\\uFF0C\\u4E5F\\u5C31\\u662F\\u675C\\u7EDD\\u78B0\\u649E\\u3002\"}),(0,n.jsx)(e.p,{children:\"\\u4F46\\u4E8B\\u5B9E\\u4E0A\\u5F71\\u54CD\\u78B0\\u649E\\u6548\\u679C\\u7684\\u56E0\\u7D20\\u53EA\\u6709\\u4E24\\u4E2A\\uFF1A\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:\"\\u6807\\u8BC6\\u7B26\\u7684\\u603B\\u91CF\\uFF0C\\u5373\\u6709\\u591A\\u5C11\\u79CD\\u53EF\\u80FD\\u6027\"}),(0,n.jsx)(e.li,{children:\"\\u6807\\u8BC6\\u7B26\\u7684\\u751F\\u6210\\u7B56\\u7565\"})]}),(0,n.jsxs)(e.p,{children:[\"\\u4E3A\\u4E86\\u907F\\u514D\\u57FA\\u4E8E\\u751F\\u65E5\\u6096\\u8BBA\\uFF08\",(0,n.jsx)(e.a,{href:\"https://en.wikipedia.org/wiki/Birthday_problem\",children:\"birthday paradox\"}),\"\\uFF09\\u7684\\u653B\\u51FB\\uFF0C\\u6211\\u4EEC\\u751F\\u6210\\u7684\\u6807\\u8BC6\\u7B26\\u7531 \",(0,n.jsx)(e.code,{children:\"64\"}),\" \\u79CD\\u5B57\\u7B26\\uFF08\\u6570\\u5B57\\u3001\\u5927\\u5C0F\\u5199\\u5B57\\u6BCD\\u4EE5\\u53CA \",(0,n.jsx)(e.code,{children:\"-\"}),\" \\u548C \",(0,n.jsx)(e.code,{children:\"_\"}),\" \\uFF09\\u7EC4\\u6210 \",(0,n.jsx)(e.code,{children:\"22\"}),\" \\u4F4D\\u5B57\\u7B26\\u4E32\\uFF0C\\u6BD4\\u5982 \",(0,n.jsx)(e.code,{children:\"EB5iGydiUL0h4bRu1ZyRIi\"}),\" \\u548C \",(0,n.jsx)(e.code,{children:\"HV2ZKGVJJklN0eH35IgNaB\"}),\"\\u3002\\u4E5F\\u5C31\\u662F\\u8BF4\\u6807\\u8BC6\\u7B26\\u603B\\u5171\\u5B58\\u5728 2^132 \\u79CD\\u53EF\\u80FD\\u6027\\uFF0C\\u5982\\u679C\\u6BCF\\u79D2\\u4F1A\\u751F\\u6210\\u4E00\\u767E\\u4E07\\u4E2A\\u6807\\u8BC6\\u7B26\\uFF0C\\u90A3\\u4E48\\u5728\\u672A\\u6765\\u4E09\\u767E\\u5E74\\u5185\\u53D1\\u751F\\u78B0\\u649E\\u7684\\u51E0\\u7387\\u53EA\\u6709\\u516D\\u5341\\u4EBF\\u5206\\u4E4B\\u4E00\\u3002\"]}),(0,n.jsxs)(e.p,{children:[\"\\u6709\\u4E86\\u8DB3\\u591F\\u7684\\u6807\\u8BC6\\u7B26\\u4E4B\\u540E\\uFF0C\\u6211\\u4EEC\\u5C31\\u8981\\u8003\\u8651\\u6807\\u8BC6\\u7B26\\u7684\\u751F\\u6210\\u7B56\\u7565\\u3002\\u4F20\\u7EDF\\u65B9\\u5F0F\\u662F\\u4F7F\\u7528\\u4F2A\\u968F\\u673A\\u6570\\u5B57\\u751F\\u6210\\u5668\\uFF08PRNG\\uFF09\\uFF0C\\u8FD9\\u4E00\\u751F\\u6210\\u5668\\u4E5F\\u662F\\u8BB8\\u591A\\u6807\\u51C6\\u5E93\\u7684\\u9009\\u62E9\\u3002\\u56E0\\u4E3A\\u6211\\u4EEC\\u7684\\u5F88\\u591A\\u670D\\u52A1\\u662F\\u57FA\\u4E8E Node.js \\u6784\\u5EFA\\u7684\\uFF0C\\u6240\\u4EE5\\u4F1A\\u7528\\u5230 V8 \\u5F15\\u64CE\\u4E2D\\u7684 \",(0,n.jsx)(e.code,{children:\"Math.random()\"}),\"\\uFF0C\\u8BE5\\u51FD\\u6570\\u8FD4\\u56DE\\u4E00\\u4E2A \",(0,n.jsx)(e.code,{children:\"[0, 1)\"}),\" \\u4E4B\\u95F4\\u7684\\u6570\\u5B57\\u3002\"]}),(0,n.jsx)(e.pre,{className:\"language-javascript\",children:(0,n.jsxs)(e.code,{className:\"language-javascript code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"ALPHABET\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function function-variable\",children:\"random_base64\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"random_base64\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token parameter\",children:\"length\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" str \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"''\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"for\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\" length\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"++\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" rand \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name known-class-name\",children:\"Math\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function property-access method\",children:\"floor\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name known-class-name\",children:\"Math\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function property-access method\",children:\"random\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"ALPHABET\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"length\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    str \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"ALPHABET\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function property-access method\",children:\"substring\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"rand\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" rand \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"return\"}),` str\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u5728\\u4E0A\\u9762\\u7684\\u4EE3\\u7801\\u4E2D\\u6211\\u4EEC\\u521B\\u5EFA\\u4E86\\u4E00\\u4E2A\\u5305\\u542B\\u6240\\u6709\\u5B57\\u7B26\\u7684\\u5E8F\\u5217\\uFF0C\\u7136\\u540E\\u57FA\\u4E8E \",(0,n.jsx)(e.code,{children:\"Math.random()\"}),\" \\u7684\\u8FD4\\u56DE\\u503C\\u4ECE\\u4E2D\\u968F\\u673A\\u9009\\u53D6\\u5B57\\u7B26\\uFF0C\\u6700\\u7EC8\\u62FC\\u63A5\\u6210\\u957F\\u4E3A \",(0,n.jsx)(e.code,{children:\"length\"}),\" \\u7684\\u6807\\u8BC6\\u7B26\\u5B57\\u7B26\\u4E32\\u3002\"]}),(0,n.jsxs)(e.p,{children:[\"\\u8FD9\\u4E00\\u751F\\u6210\\u7B56\\u7565\\u770B\\u8D77\\u6765\\u5F88\\u5B8C\\u7F8E\\uFF0C\\u76F4\\u5230\\u6709\\u4E00\\u5929\\u6211\\u4EEC\\u6536\\u5230\\u4E86 \",(0,n.jsx)(e.a,{href:\"https://twitter.com/forte_nick\",children:\"Nick Forte\"}),\" \\u7684\\u90AE\\u4EF6\\uFF0C\\u4ED6\\u5728\\u90AE\\u4EF6\\u4E2D\\u58F0\\u79F0\\u5B83\\u63A5\\u6536\\u5230\\u4E86\\u4E24\\u4E2A\\u76F8\\u540C\\u7684\\u6807\\u8BC6\\u7B26\\u3002\\u8FD9\\u8BA9\\u6211\\u4EEC\\u610F\\u8BC6\\u5230\\u5176\\u4E2D\\u5FC5\\u6709\\u8E4A\\u8DF7\\u3002John von Neumann \\u66FE\\u7ECF\\u6BEB\\u4E0D\\u7559\\u60C5\\u5730\\u6307\\u8D23\\uFF1A\\u201C\\u5F00\\u53D1\\u8005\\u5BF9\\u4F7F\\u7528\\u7B97\\u6CD5\\u751F\\u6210\\u968F\\u673A\\u6570\\u7684\\u81EA\\u8D1F\\u548C\\u6267\\u8FF7\\u4E0D\\u609F\\uFF0C\\u662F\\u4E00\\u5207\\u7684\\u539F\\u7F6A\\u3002\\u201D\\u7B80\\u800C\\u8A00\\u4E4B\\uFF0C\\u786E\\u5B9A\\u6027\\u7684\\u65B9\\u6CD5\\u65E0\\u6CD5\\u771F\\u5B9E\\u5730\\u521B\\u9020\\u968F\\u673A\\u6027\\uFF0C\\u6BD4\\u5982\\u6570\\u7406\\u8FD0\\u7B97\\u3002\\u8FD9\\u9053\\u7406\\u542C\\u8D77\\u6765\\u77DB\\u76FE\\u91CD\\u91CD\\u4F3C\\u662F\\u800C\\u975E\\u2026\\u2026\"]}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"\",src:\"http://cdn2.w3cplus.com/cdn/farfuture/bfbv1ozSPL_vXz2KytLcs783LNsZuMrrSVYg6JvBBmo/mtime:1462031115/sites/default/files/blogs/2016/1604/math-random-6.png\"})}),(0,n.jsxs)(e.h2,{id:\"prng\",children:[(0,n.jsx)(e.a,{href:\"#prng\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"PRNG\"]}),(0,n.jsxs)(e.p,{children:[\"\\u4ECE\\u4E0B\\u56FE\\u6F14\\u793A\\u7684\\u968F\\u673A\\u6570\\u751F\\u6210\\u6D41\\u7A0B\\u4E2D\\u53EF\\u4EE5\\u6E05\\u6670\\u770B\\u51FA\\uFF0C\",(0,n.jsx)(e.a,{href:\"https://gist.github.com/mmalone/6ef9fabe1a7540ae89e8\",children:\"PRNG \\u7B97\\u6CD5\"}),\"\\u751F\\u6210\\u7684\\u5E76\\u4E0D\\u662F\\u968F\\u673A\\u6570\\uFF0C\\u800C\\u662F\\u4E00\\u79CD\\u4F2A\\u968F\\u673A\\u3002\\u5BF9\\u4E8E\\u5927\\u591A\\u6570\\u7684\\u4F7F\\u7528\\u573A\\u666F\\uFF0C\\u4F2A\\u968F\\u673A\\u7684\\u505A\\u6CD5\\u5E76\\u6CA1\\u6709\\u9519\\uFF0C\\u91CD\\u70B9\\u662F\\u8FD9\\u79CD\\u4F2A\\u968F\\u673A\\u8981\\u8DB3\\u591F\\u4EE5\\u5047\\u4E71\\u771F\\u3002\\u5728\\u4F2A\\u968F\\u673A\\u6027\\u4E4B\\u5916\\uFF0C\\u4E0B\\u56FE\\u8FD8\\u63ED\\u793A\\u4E86\\u53E6\\u4E00\\u4E2A\\u95EE\\u9898\\uFF1A\\u5468\\u671F\\u6027\\u5FAA\\u73AF\\u3002\\u867D\\u7136\\u5468\\u671F\\u957F\\u77ED\\u90FD\\u65E0\\u6CD5\\u4FDD\\u8BC1\\u4F2A\\u968F\\u673A\\u7684\\u8D28\\u91CF\\uFF0C\\u4F46\\u957F\\u5468\\u671F\\u663E\\u7136\\u8981\\u597D\\u4E8E\\u77ED\\u5468\\u671F\\uFF0C\\u5982\\u679C\\u6211\\u4EEC\\u77E5\\u9053\\u5468\\u671F\\u7684\\u5B58\\u5728\\u4F46\\u65E0\\u6CD5\\u8BA1\\u7B97\\u8FD9\\u4E00\\u5468\\u671F\\u957F\\u5EA6\\u65F6\\uFF0C\\u90A3\\u4E48\\u5C31\\u53EF\\u4EE5\\u5C06\\u5176\\u5468\\u671F\\u4E0A\\u9650\\u89C6\\u4E3A\\u5C0F\\u4E8E\\u7B49\\u4E8E\\u968F\\u673A\\u6570\\u7684\\u6570\\u91CF\\uFF0C\\u8FD9\\u4E5F\\u662F\\u4E00\\u4E2A\\u4F18\\u79C0\\u7684 PRNG \\u7B97\\u6CD5\\u5E94\\u5177\\u6709\\u7684\\u7279\\u70B9\\u3002\"]}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"PRNG\",src:\"http://cdn2.w3cplus.com/cdn/farfuture/5mGck9m08jvih5dKSKum-gGeEizNsHrbhDl59dEWR1A/mtime:1462030402/sites/default/files/blogs/2016/1604/math-random-1.png\"})}),(0,n.jsxs)(e.p,{children:[\"\\u63A5\\u4E0B\\u6765\\uFF0C\\u8BA9\\u6211\\u4EEC\\u6DF1\\u5165\\u5206\\u6790\\u4E00\\u4E0B PRNG \\u751F\\u6210\\u7684\\u968F\\u673A\\u5E8F\\u5217\\u6240\\u5B58\\u5728\\u7684\\u7F3A\\u9677\\u3002\\u4E3E\\u4F8B\\u6765\\u8BF4\\uFF0C\\u6211\\u4EEC\\u9700\\u8981\\u4F7F\\u7528 PRNG \\u5904\\u7406 \",(0,n.jsx)(e.code,{children:\"[0, 15]\"}),\" \\u5341\\u516D\\u4E2A\\u6574\\u6570\\u751F\\u6210\\u7C7B\\u4F3C \",(0,n.jsx)(e.code,{children:\"(2, 13, 4)\"}),\" \\u548C \",(0,n.jsx)(e.code,{children:\"(5, 12, 15)\"}),\" \\u4E4B\\u7C7B\\u7684\\u5143\\u7EC4\\uFF0C\\u7406\\u8BBA\\u4E0A\\u8BF4\\u5E94\\u8BE5\\u6709 16^3 \\u79CD\\u53EF\\u80FD\\u6027\\uFF0C\\u4F46\\u7B80\\u5355\\u7684 PRNG \\u53EA\\u4F1A\\u751F\\u6210\\u5C11\\u91CF\\u7684\\u975E\\u91CD\\u590D\\u7ED3\\u679C\\uFF08\\u8FD9\\u91CC\\u662F \",(0,n.jsx)(e.code,{children:\"16\"}),\" \\u79CD\\uFF09\\uFF1A\"]}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"PRNG\",src:\"http://cdn2.w3cplus.com/cdn/farfuture/F6Uth8mGRRaMvXLOp5Jnq1cb5Pp0n44kc1bFY9Ro2Sw/mtime:1462030401/sites/default/files/blogs/2016/1604/math-random-2.png\"})}),(0,n.jsx)(e.p,{children:\"\\u8FD8\\u8BB0\\u5F97\\u672C\\u6587\\u6700\\u521D\\u63D0\\u5230\\u7684\\u968F\\u673A\\u6807\\u8BC6\\u7B26\\u5417\\uFF1F\\u751F\\u6210\\u6807\\u8BC6\\u7B26\\u7684\\u539F\\u7406\\u5C31\\u548C\\u751F\\u6210\\u4E0A\\u9762\\u7684\\u5143\\u7EC4\\u4E00\\u6837\\uFF0C\\u6700\\u7EC8\\u80FD\\u591F\\u751F\\u6210\\u7684\\u975E\\u91CD\\u590D\\u7ED3\\u679C\\u5C31\\u53D6\\u51B3\\u4E8E PRNG \\u7684\\u5185\\u90E8\\u72B6\\u6001\\u548C\\u5FAA\\u73AF\\u5468\\u671F\\u3002\"}),(0,n.jsxs)(e.h2,{id:\"mathrandom\",children:[(0,n.jsx)(e.a,{href:\"#mathrandom\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Math.random()\"]}),(0,n.jsxs)(e.p,{children:[\"\\u5BF9\\u4E8E Nick \\u5728\\u90AE\\u4EF6\\u4E2D\\u63D0\\u5230\\u7684\\u95EE\\u9898\\uFF0C\\u6211\\u4EEC\\u8FC5\\u901F\\u5BA1\\u67E5\\u4E86\\u76F8\\u5173\\u7684\\u4EE3\\u7801\\u903B\\u8F91\\uFF0C\\u4F46\\u5E76\\u6CA1\\u6709\\u627E\\u5230\\u4EFB\\u4F55\\u7F3A\\u9677\\uFF0C\\u8FD9\\u8BF4\\u660E\\u95EE\\u9898\\u6D89\\u53CA\\u7684\\u6280\\u672F\\u5C42\\u9762\\u53EF\\u80FD\\u4F1A\\u975E\\u5E38\\u6DF1\\u3002\",(0,n.jsx)(e.a,{href:\"http://www.ecma-international.org/ecma-262/6.0/#sec-math.random\",children:\"ECMAScript \\u89C4\\u8303\"}),\"\\u662F\\u8FD9\\u6837\\u63CF\\u8FF0 \",(0,n.jsx)(e.code,{children:\"Math.random()\"}),\" \\u7684\\uFF1A\\u201C\\u8FD4\\u56DE\\u4E00\\u4E2A\\u6574\\u6570\\uFF0C\\u8BE5\\u6574\\u6570\\u7684\\u53D6\\u503C\\u8303\\u56F4\\u5927\\u4E8E\\u7B49\\u4E8E \",(0,n.jsx)(e.code,{children:\"0\"}),\" \\u800C\\u5C0F\\u4E8E \",(0,n.jsx)(e.code,{children:\"1\"}),\"\\uFF0C\\u6D4F\\u89C8\\u5668\\u5F00\\u53D1\\u5546\\u4F7F\\u7528\\u81EA\\u5B9A\\u4E49\\u7684\\u7B97\\u6CD5\\u6216\\u7B56\\u7565\\u4ECE\\u8BE5\\u8303\\u56F4\\u5185\\u5B9E\\u73B0\\u5747\\u5300\\u5206\\u5E03\\u7684\\u968F\\u673A\\u6216\\u4F2A\\u968F\\u673A\\u6548\\u679C\\u3002\\u201D\"]}),(0,n.jsxs)(e.p,{children:[\"\\u663E\\u7136\\uFF0C\\u89C4\\u8303\\u4E2D\\u9057\\u6F0F\\u4E86\\u5927\\u91CF\\u7684\\u7EC6\\u8282\\u3002\\u9996\\u5148\\uFF0C\\u5B83\\u6CA1\\u6709\\u5B9A\\u4E49\\u7CBE\\u5EA6\\u3002\\u7531\\u4E8E ECMAScript \\u4F7F\\u7528 IEEE 754 \\u53CC\\u7CBE\\u5EA6\\u6D6E\\u70B9\\u6570\\u5B58\\u50A8\\u6240\\u6709\\u6570\\u503C\\uFF0C\\u6240\\u4EE5\\u7406\\u8BBA\\u4E0A\\u5E94\\u8BE5\\u6709 \",(0,n.jsx)(e.code,{children:\"53\"}),\" \\u4F4D\\u7684\\u7CBE\\u786E\\u5EA6\\uFF0C\\u5373\\u968F\\u673A\\u6570\\u7684\\u968F\\u673A\\u8303\\u56F4\\u662F \",(0,n.jsx)(e.code,{children:\"[1/x^53, 2^53-1]\"}),\"\\uFF0C\\u4F46\\u5B9E\\u9645\\u4E0A\\uFF0CV8 \\u4E2D\\u7684 \",(0,n.jsx)(e.code,{children:\"Math.random()\"}),\" \\u53EA\\u6709 \",(0,n.jsx)(e.code,{children:\"32\"}),\" \\u4F4D\\u7CBE\\u5EA6\\uFF0C\\u4E0D\\u8FC7\\u8FD9\\u5DF2\\u7ECF\\u8DB3\\u591F\\u6211\\u4EEC\\u7528\\u7684\\u4E86\\u3002\"]}),(0,n.jsx)(e.p,{children:\"\\u771F\\u6B63\\u7684\\u95EE\\u9898\\u662F\\u89C4\\u8303\\u653E\\u4EFB\\u6D4F\\u89C8\\u5668\\u5F00\\u53D1\\u8005\\u81EA\\u7531\\u5B9E\\u73B0\\u8BE5\\u65B9\\u6CD5\\uFF0C\\u4E14\\u6CA1\\u6709\\u9650\\u5236\\u6700\\u5C0F\\u7684\\u5468\\u671F\\u957F\\u5EA6\\uFF0C\\u552F\\u4E00\\u5BF9\\u5206\\u5E03\\u7684\\u8981\\u6C42\\u4E5F\\u53EA\\u662F\\u201C\\u8FD1\\u4F3C\\u5747\\u5300\\u201D\\u3002\"}),(0,n.jsxs)(e.h2,{id:\"v8-prng\",children:[(0,n.jsx)(e.a,{href:\"#v8-prng\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"V8 PRNG\"]}),(0,n.jsx)(e.pre,{className:\"language-javascript\",children:(0,n.jsxs)(e.code,{className:\"language-javascript code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"MAX_RAND\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name known-class-name\",children:\"Math\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function property-access method\",children:\"pow\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"32\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" state \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"seed\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"seed\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" \",(0,n.jsx)(e.span,{className:\"token function function-variable\",children:\"mwc1616\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"mwc1616\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" r0 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"18030\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"state\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0xffff\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"state\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\u003e\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" r1 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"36969\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"state\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0xffff\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"state\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003e\u003e\u003e\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  state \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"r0\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" r1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" x \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"r0 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\u003c\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"r1 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0xffff\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"if\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"x \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    x \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" x \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"MAX_RAND\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"return\"}),\" x \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"/\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"MAX_RAND\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"\\u4E0A\\u8FF0\\u4EE3\\u7801\\u5C31\\u662F V8 PRNG \\u7684\\u6838\\u5FC3\\u903B\\u8F91\\u3002\\u5728\\u8001\\u7248\\u672C\\u7684 V8 \\u6E90\\u7801\\u4E2D\\u5BF9\\u6B64\\u6709\\u4E00\\u6BB5\\u6CE8\\u91CA\\uFF1A\\u201C\\u968F\\u673A\\u6570\\u751F\\u6210\\u5668\\u4F7F\\u7528\\u4E86 George Marsaglia \\u7684 MWC \\u7B97\\u6CD5\\u3002\\u201D\\u6839\\u636E\\u8FD9\\u6BB5\\u6CE8\\u91CA\\uFF0C\\u6211\\u4ECE\\u8C37\\u6B4C\\u641C\\u7D22\\u5230\\u4E86\\u4EE5\\u4E0B\\u4FE1\\u606F\\uFF1A\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.a,{href:\"https://en.wikipedia.org/wiki/George_Marsaglia\",children:\"George Marsaglia\"}),\" \\u662F\\u4E00\\u4E2A\\u6BD5\\u751F\\u81F4\\u529B\\u4E8E PRNG \\u7684\\u6570\\u5B66\\u5BB6\\uFF0C\\u4ED6\\u8FD8\\u5F00\\u53D1\\u4E86\\u7528\\u4E8E\\u6D4B\\u8BD5\\u968F\\u673A\\u6570\\u751F\\u6210\\u8D28\\u91CF\\u7684\\u5DE5\\u5177 \",(0,n.jsx)(e.a,{href:\"https://en.wikipedia.org/wiki/Diehard_tests\",children:\"Diehard tests\"})]}),(0,n.jsxs)(e.li,{children:[\"MWC\\uFF08\",(0,n.jsx)(e.a,{href:\"https://en.wikipedia.org/wiki/Multiply-with-carry\",children:\"multiply-with-carry\"}),\"\\uFF09\\u662F\\u7531 \",(0,n.jsx)(e.a,{href:\"http://digitalcommons.wayne.edu/cgi/viewcontent.cgi?article=1725\u0026context=jmasm\",children:\"Marsaglia\"}),\" \\u53D1\\u660E\\u7684 PRNG \\u7B97\\u6CD5\\uFF0C\\u975E\\u5E38\\u7C7B\\u4F3C\\u4E8E \",(0,n.jsx)(e.a,{href:\"https://en.wikipedia.org/wiki/Linear_congruential_generator\",children:\"LCG\"}),\"\\uFF08linear congruential generators\\uFF0C\\u7EBF\\u6027\\u540C\\u4F59\\u6CD5\\uFF09\\uFF0C\\u5176\\u4F18\\u52BF\\u5728\\u4E8E\\u751F\\u6210\\u7684\\u5FAA\\u73AF\\u5468\\u671F\\u66F4\\u957F\\uFF0C\\u63A5\\u8FD1\\u4E8E CPU \\u7684\\u5FAA\\u73AF\\u5468\\u671F\\u3002\"]})]}),(0,n.jsxs)(e.p,{children:[\"\\u4E0D\\u8FC7\\uFF0CV8 PRNG \\u4E0E\\u7ECF\\u5178\\u7684 MWC \\u751F\\u6210\\u5668\\u5E76\\u4E0D\\u76F8\\u540C\\uFF0C\\u56E0\\u4E3A\\u5B83\\u4E0D\\u662F\\u5BF9 MWC \\u751F\\u6210\\u5668\\u7684\\u7B80\\u5355\\u6269\\u5C55\\uFF0C\\u800C\\u662F\\u7EC4\\u5408\\u4F7F\\u7528\\u4E86\\u4E24\\u4E2A MWC \\u5B50\\u751F\\u6210\\u5668\\uFF08\",(0,n.jsx)(e.code,{children:\"r0\"}),\" \\u548C \",(0,n.jsx)(e.code,{children:\"r1\"}),\"\\uFF09\\uFF0C\\u5E76\\u6700\\u7EC8\\u62FC\\u63A5\\u6210\\u4E00\\u4E2A\\u968F\\u673A\\u6570\\u3002\\u8FD9\\u91CC\\u7565\\u8FC7\\u76F8\\u5173\\u7684\\u6570\\u5B66\\u8BA1\\u7B97\\uFF0C\\u53EA\\u8BF4\\u7ED3\\u8BBA\\uFF0C\\u6BCF\\u4E2A\\u5B50\\u751F\\u6210\\u5668\\u6700\\u957F\\u7684\\u5FAA\\u73AF\\u5468\\u671F\\u957F\\u5EA6\\u90FD\\u662F 2^30\\uFF0C\\u5408\\u5E76\\u540E\\u4E3A 2^60\\u3002\"]}),(0,n.jsxs)(e.p,{children:[\"\\u4E0A\\u6587\\u63D0\\u5230\\u8FC7\\uFF0C\\u6211\\u4EEC\\u5B9A\\u4E49\\u7684\\u6807\\u8BC6\\u7B26\\u6709 2^132 \\u79CD\\u53EF\\u80FD\\u6027\\uFF0C\\u6240\\u4EE5 V8 \\u7684 \",(0,n.jsx)(e.code,{children:\"Math.random()\"}),\" \\u5E76\\u4E0D\\u80FD\\u6EE1\\u8DB3\\u8FD9\\u4E00\\u9700\\u6C42\\u3002\\u5C3D\\u7BA1\\u5982\\u6B64\\uFF0C\\u6211\\u4EEC\\u4ECD\\u4F7F\\u7528\\u8BE5\\u51FD\\u6570\\u5E76\\u5047\\u8BBE\\u751F\\u6210\\u7684\\u968F\\u673A\\u6570\\u662F\\u5747\\u5300\\u5206\\u5E03\\u7684\\uFF0C\\u90A3\\u4E48\\u751F\\u6210\\u4E00\\u4EBF\\u4E2A\\u6807\\u8BC6\\u7B26\\u540E\\u51FA\\u73B0\\u78B0\\u649E\\u7684\\u53EF\\u80FD\\u6027\\u624D\\u53EA\\u6709 \",(0,n.jsx)(e.code,{children:\"0.4%\"}),\"\\uFF0C\\u4F46\\u73B0\\u5728\\u53D1\\u751F\\u78B0\\u649E\\u7684\\u65F6\\u95F4\\u4E5F\\u592A\\u65E9\\u4E86\\uFF0C\\u6240\\u4EE5\\u6211\\u4EEC\\u7684\\u5206\\u6790\\u4E00\\u5B9A\\u6709\\u4EC0\\u4E48\\u5730\\u65B9\\u51FA\\u9519\\u4E86\\u3002\\u4E4B\\u524D\\u5DF2\\u7ECF\\u8BC1\\u660E\\u5FAA\\u73AF\\u5468\\u671F\\u957F\\u5EA6\\u662F\\u6B63\\u786E\\u7684\\uFF0C\\u90A3\\u4E48\\u5F88\\u6709\\u53EF\\u80FD\\u751F\\u6210\\u7684\\u968F\\u673A\\u6570\\u4E0D\\u662F\\u5747\\u5300\\u5206\\u5E03\\u7684\\uFF0C\\u4E00\\u5B9A\\u6709\\u5176\\u4ED6\\u7684\\u7ED3\\u6784\\u5F71\\u54CD\\u4E86\\u751F\\u6210\\u7684\\u5E8F\\u5217\\u3002\"]}),(0,n.jsxs)(e.h2,{id:\"\\u53CC\\u5B50\\u751F\\u6210\\u5668\",children:[(0,n.jsx)(e.a,{href:\"#\\u53CC\\u5B50\\u751F\\u6210\\u5668\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u53CC\\u5B50\\u751F\\u6210\\u5668\"]}),(0,n.jsx)(e.pre,{className:\"language-javascript\",children:(0,n.jsxs)(e.code,{className:\"language-javascript code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"ALPHABET\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token function function-variable\",children:\"random_base64\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"random_base64\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token parameter\",children:\"length\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" str \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:\"''\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"for\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" i \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\"}),\" length\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"++\"}),\"i\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Math.random(): ((r0 \u003c\u003c 16) + (r1 \u0026 0xFFFF)) | 0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" rand \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token class-name known-class-name\",children:\"Math\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function property-access method\",children:\"floor\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token class-name known-class-name\",children:\"Math\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function property-access method\",children:\"random\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"ALPHABET\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token property-access\",children:\"length\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    str \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+=\"}),\" \",(0,n.jsx)(e.span,{className:\"token constant\",children:\"ALPHABET\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function property-access method\",children:\"substring\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"rand\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" rand \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"  \",(0,n.jsx)(e.span,{className:\"token keyword control-flow\",children:\"return\"}),` str\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.p,{children:[\"\\u4E0A\\u9762\\u4EE3\\u7801\\u4E2D\\u7684 \",(0,n.jsx)(e.code,{children:\"Math.floor(Math.random() * ALPHABET.length)\"}),\" \\u4E00\\u53E5\\u975E\\u5E38\\u91CD\\u8981\\uFF0C\\u5B83\\u88AB\\u7528\\u6765\\u6269\\u5927\\u968F\\u673A\\u6570\\u7684\\u8303\\u56F4\\u5E76\\u53D6\\u6574\\uFF0C\\u540C\\u65F6\\u5B83\\u4E5F\\u4F1A\\u8BA9\\u6700\\u7EC8\\u7684\\u968F\\u673A\\u6570\\u4E22\\u5931\\u4F4E\\u5B57\\u8282\\uFF0C\\u503E\\u5411\\u4E8E\\u9AD8\\u5B57\\u8282\\u3002\\u7A76\\u5176\\u539F\\u56E0\\uFF0C\\u662F\\u56E0\\u4E3A V8 \\u7684\\u7B97\\u6CD5\\u5728\\u5408\\u5E76\\u4E24\\u4E2A\\u5B50\\u751F\\u6210\\u5668\\u7684\\u7ED3\\u679C\\u65F6\\uFF0C\\u4F7F\\u7528\\u7684\\u4E0D\\u662F\\u5F02\\u6216\\u8BA1\\u7B97\\uFF0C\\u800C\\u662F\\u7B80\\u5355\\u7C97\\u66B4\\u7684\\u62FC\\u63A5\\u3002\\u8FD9\\u662F\\u975E\\u5E38\\u4E25\\u91CD\\u7684\\u7F3A\\u9677\\u3002\\u5F53\\u6211\\u4EEC\\u5C06 \",(0,n.jsx)(e.code,{children:\"Math.random()\"}),\" \\u7684\\u8303\\u56F4\\u6269\\u5C55\\u5230 \",(0,n.jsx)(e.code,{children:\"[0, 64]\"}),\" \\u5E76\\u53D6\\u6574\\u540E\\uFF0C\\u5C31\\u5DF2\\u7ECF\\u6539\\u53D8\\u4E86\\u5B83\\u7684\\u5E73\\u8861\\u6027\\uFF0C\\u66F4\\u591A\\u7684\\u503E\\u5411\\u4E8E\\u4F7F\\u7528\\u9AD8\\u4F4D\\u5B57\\u8282\\u3002\\u8FD9\\u4E9B\\u9AD8\\u4F4D\\u5B57\\u8282\\u901A\\u5E38\\u6765\\u81EA\\u4E8E MWC \\u5B50\\u751F\\u6210\\u5668\\u4E2D\\u7684\\u7B2C\\u4E00\\u4E2A\\u751F\\u6210\\u5668\\u3002\"]}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"\\u53CC\\u5B50\\u751F\\u6210\\u5668\",src:\"http://cdn2.w3cplus.com/cdn/farfuture/qPSPvklNkAJ_kiisudbrAGZihfbB0Jqhecd8kAEOjIg/mtime:1462030404/sites/default/files/blogs/2016/1604/math-random-3.png\"})}),(0,n.jsxs)(e.p,{children:[\"\\u5982\\u679C\\u5355\\u72EC\\u5206\\u6790\\u4E00\\u4E0B\\u7B2C\\u4E00\\u4E2A\\u5B50\\u751F\\u6210\\u5668\\uFF0C\\u5C31\\u4F1A\\u53D1\\u73B0\\u5B83\\u5177\\u6709 \",(0,n.jsx)(e.code,{children:\"32\"}),\" \\u4F4D\\u7684\\u5185\\u90E8\\u72B6\\u6001\\uFF0C\\u5B9E\\u9645\\u7684\\u5FAA\\u73AF\\u5468\\u671F\\u957F\\u5EA6\\u662F \",(0,n.jsx)(e.code,{children:\"5.9\"}),\" \\u4EBF\\u5DE6\\u53F3\\uFF08\",(0,n.jsx)(e.code,{children:\"18030*2^15\"}),\"\\uFF0C\\u8BA1\\u7B97\\u7EC6\\u8282\\u8BF7\\u53C2\\u8003\\u6587\\u672B\\u8D44\\u6599\\uFF09\\uFF0C\\u6240\\u4EE5\\u4F7F\\u7528\\u8FD9\\u4E2A\\u751F\\u6210\\u5668\\u53EA\\u80FD\\u751F\\u6210 \",(0,n.jsx)(e.code,{children:\"5.9\"}),\" \\u4EBF\\u6807\\u8BC6\\u7B26\\uFF0C\\u4E5F\\u5C31\\u662F\\u751F\\u6210 \",(0,n.jsx)(e.code,{children:\"30000\"}),\" \\u4E2A\\u6807\\u8BC6\\u7B26\\u540E\\u5C31\\u6709\\u8D85\\u8FC7 \",(0,n.jsx)(e.code,{children:\"50%\"}),\" \\u7684\\u6982\\u7387\\u53D1\\u751F\\u78B0\\u649E\\u3002\"]}),(0,n.jsx)(e.p,{children:\"\\u4F46\\u5982\\u679C\\u8FD9\\u662F\\u771F\\u7684\\u8BDD\\uFF0C\\u90A3\\u4E48\\u5728\\u751F\\u6210\\u6807\\u8BC6\\u7B26\\u4E4B\\u540E\\u4E0D\\u4E45\\u5C31\\u4F1A\\u53D1\\u751F\\u78B0\\u649E\\u3002\\u4E3A\\u4E86\\u7406\\u89E3\\u8FD9\\u4E00\\u73B0\\u8C61\\uFF0C\\u60F3\\u60F3\\u6211\\u4EEC\\u4E4B\\u524D\\u751F\\u6210\\u5143\\u7EC4\\u7684\\u793A\\u4F8B\\uFF0C\\u5728\\u8FD9\\u4E2A\\u793A\\u4F8B\\u4E2D\\u4E5F\\u6CA1\\u53D1\\u751F\\u751F\\u65E5\\u6096\\u8BBA\\uFF0C\\u8FD9\\u662F\\u56E0\\u4E3A\\u8FD9\\u4E2A\\u5E8F\\u5217\\u6839\\u672C\\u4E0D\\u662F\\u968F\\u673A\\u7684\\uFF0C\\u6240\\u4EE5\\u4E0D\\u80FD\\u5047\\u88C5\\u5B83\\u662F\\u3002V8 PRNG \\u548C\\u6211\\u4EEC\\u7684\\u968F\\u673A\\u6807\\u8BC6\\u7B26\\u4E5F\\u662F\\u540C\\u6837\\u7684\\u9053\\u7406\\uFF0C\\u5728\\u7279\\u5B9A\\u6761\\u4EF6\\u4E0B\\uFF0CPRNG \\u7684\\u4F2A\\u968F\\u673A\\u6027\\u53CD\\u5012\\u4E0D\\u6613\\u751F\\u6210\\u78B0\\u649E\\u3002\"}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"\\u53CC\\u5B50\\u751F\\u6210\\u5668\",src:\"http://cdn1.w3cplus.com/cdn/farfuture/mYUDjnNzT142NJPAzNnZnFZAUPhUcSgB29-H0UXjgm4/mtime:1462030402/sites/default/files/blogs/2016/1604/math-random-4.png\"})}),(0,n.jsxs)(e.p,{children:[\"\\u867D\\u7136\\u5728\\u8FD9\\u79CD\\u573A\\u666F\\u4E0B\\u751F\\u6210\\u5668\\u5BF9\\u6211\\u4EEC\\u7684\\u9700\\u6C42\\u6709\\u76CA\\uFF0C\\u4F46\\u65E2\\u7136\\u5B58\\u5728\\u9519\\u8BEF\\uFF0C\\u6211\\u4EEC\\u5C31\\u5E94\\u8BE5\\u5BFB\\u6C42\\u66F4\\u9AD8\\u8D28\\u91CF\\u7684 PRNG\\uFF0C\\u4E00\\u4E2A\\u6709\\u6548\\u7684\\u65B9\\u5F0F\\u5C31\\u662F\\u8BA9\\u751F\\u6210\\u5668\\u7684\\u5FAA\\u73AF\\u5468\\u671F\\u957F\\u5EA6\\u8FDC\\u5927\\u4E8E\\u968F\\u673A\\u6570\\u7684\\u53EF\\u80FD\\u6027\\u3002\\u8FD9\\u91CC\\u6709\\u4E00\\u4E2A\\u542F\\u53D1\\u5F0F\\u7684\\u65B9\\u6CD5\\uFF1A\\u5982\\u679C\\u9700\\u8981\\u751F\\u6210\\u5177\\u6709 \",(0,n.jsx)(e.code,{children:\"n\"}),\" \\u4E2D\\u53EF\\u80FD\\u6027\\u7684\\u968F\\u673A\\u6570\\uFF0C\\u90A3\\u4E48\\u5C31\\u9700\\u8981\\u4E00\\u4E2A\\u5FAA\\u73AF\\u5468\\u671F\\u957F\\u5EA6\\u4E3A \",(0,n.jsx)(e.code,{children:\"n^2\"}),\" \\u7684 PRNG\\uFF08\\u76F8\\u5173\\u7EC6\\u8282\\u8BF7\\u53C2\\u8003 Pierre L'Ecuyer \\u7684 \",(0,n.jsx)(e.a,{href:\"http://www.iro.umontreal.ca/~lecuyer/myftp/papers/handstat.pdf\",children:\"random number generation\"}),\"\\uFF09\\u3002\"]}),(0,n.jsxs)(e.p,{children:[\"\\u5BF9\\u4E8E\\u6211\\u4EEC\\u6240\\u9047\\u5230\\u7684\\u95EE\\u9898\\uFF0C\\u53EF\\u4EE5\\u8BF4\\u662F\\u8FC7\\u4E8E\\u5173\\u6CE8\\u5E8F\\u5217\\u7684\\u91CD\\u53E0\\u5EA6\\uFF0C\\u800C\\u5FFD\\u89C6\\u7EDF\\u8BA1\\u968F\\u673A\\u6027\\u4E86\\u3002\\u5982\\u679C\\u4E00\\u4E2A\\u751F\\u6210\\u5668\\u8981\\u751F\\u6210 \",(0,n.jsx)(e.code,{children:\"n\"}),\" \\u4E2A\\u957F\\u5EA6\\u4E3A \",(0,n.jsx)(e.code,{children:\"l\"}),\" \\u7684\\u5E8F\\u5217\\uFF0C\\u4E14\\u5FAA\\u73AF\\u5468\\u671F\\u957F\\u5EA6\\u4E3A \",(0,n.jsx)(e.code,{children:\"p\"}),\"\\uFF0C\\u90A3\\u4E48\\u5176\\u91CD\\u53E0\\u6982\\u7387\\u5C31\\u662F \",(0,n.jsx)(e.code,{children:\"[1-(nl)/(p-1)]^(n-1)\"}),\"\\uFF0C\\u6216\\u5F53 \",(0,n.jsx)(e.code,{children:\"p\"}),\" \\u8DB3\\u591F\\u5927\\u65F6\\u63A5\\u8FD1 \",(0,n.jsx)(e.code,{children:\"ln^2/p\"}),\"\\uFF08\\u76F8\\u5173\\u7EC6\\u8282\\u8BF7\\u53C2\\u8003\\u6587\\u672B\\u8D44\\u6599\\uFF09\\u3002\\u8FD9\\u544A\\u8BC9\\u6211\\u4EEC\\u9700\\u8981\\u4E00\\u4E2A\\u76F8\\u5F53\\u5927\\u7684\\u5FAA\\u73AF\\u5468\\u671F\\uFF0C\\u5426\\u5219\\u5E8F\\u5217\\u7684\\u968F\\u673A\\u6027\\u5C31\\u4F1A\\u53D8\\u5F97\\u8106\\u5F31\\u3002\"]}),(0,n.jsxs)(e.p,{children:[\"\\u7B80\\u800C\\u8A00\\u4E4B\\uFF0C\\u5982\\u679C\\u4F60\\u6B63\\u5728\\u4F7F\\u7528 V8 \\u7684 \",(0,n.jsx)(e.code,{children:\"Math.random()\"}),\" \\u751F\\u6210\\u968F\\u673A\\u6570\\u5E8F\\u5217\\uFF0C\\u90A3\\u4E48\\u4E3A\\u4E86\\u4FDD\\u8BC1\\u968F\\u673A\\u6027\\uFF0C\\u5E8F\\u5217\\u957F\\u5EA6\\u5E94\\u8BE5\\u5C0F\\u4E8E \",(0,n.jsx)(e.code,{children:\"24000\"}),\"\\uFF1B\\u5982\\u679C\\u60F3\\u907F\\u514D\\u78B0\\u649E\\uFF0C\\u90A3\\u4E48\\u5E94\\u8BE5\\u9009\\u62E9\\u5176\\u4ED6\\u7684\\u65B9\\u6CD5\\u751F\\u6210\\u968F\\u673A\\u5E8F\\u5217\\u3002\"]}),(0,n.jsxs)(e.h2,{id:\"mwc1616\",children:[(0,n.jsx)(e.a,{href:\"#mwc1616\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"MWC1616\"]}),(0,n.jsx)(e.p,{children:\"Marsaglia \\u5728 1997 \\u5E74\\u63D0\\u51FA\\u4E86 MWC1616\\uFF0C\\u4ED6\\u8BA4\\u4E3A\\u8BE5\\u65B9\\u6CD5\\u53EF\\u4EE5\\u901A\\u8FC7\\u6240\\u6709\\u7684\\u968F\\u673A\\u6027\\u6D4B\\u8BD5\\u3002\\u4E0D\\u5E78\\u7684\\u662F\\uFF0C\\u4ED6\\u5728\\u4E5D\\u5341\\u5E74\\u4EE3\\u672B\\u4F7F\\u7528\\u7684 Diehard tests \\u5E76\\u4E0D\\u7B26\\u5408\\u4ECA\\u5929\\u7684\\u6807\\u51C6\\u3002\\u5982\\u679C\\u4F7F\\u7528\\u66F4\\u52A0\\u73B0\\u4EE3\\u7684\\u6D4B\\u8BD5\\u6846\\u67B6\\u6D4B\\u8BD5\\uFF0C\\u5C31\\u4F1A\\u53D1\\u73B0\\u8BE5\\u7B97\\u6CD5\\u5728\\u5F53\\u65F6\\u95EE\\u9898\\u767E\\u51FA\\u3002\"}),(0,n.jsx)(e.pre,{className:\"language-javascript\",children:(0,n.jsxs)(e.code,{className:\"language-javascript code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// January 12, 1999 / V8 PRNG: ((r0 \u003c\u003c 16) + (r1 ^ 0xFFFF)) % 2^32\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" x \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"r0 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\u003c\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"r1 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0xffff\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token comment\",children:\"// January 20, 1999: (r0 \u003c\u003c 16) + r1) % 2^32\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" x \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"r0 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u003c\u003c\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"16\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"+\"}),\" r1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"|\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]})]})}),(0,n.jsx)(e.p,{children:\"\\u5C31\\u6211\\u6240\\u77E5\\uFF0C\\u62FC\\u63A5\\u5B50\\u751F\\u6210\\u5668\\u7684\\u7ED3\\u679C\\u521B\\u9020\\u968F\\u673A\\u6570\\u5E76\\u6CA1\\u6709\\u4EC0\\u4E48\\u6570\\u5B66\\u65B9\\u9762\\u7684\\u4F9D\\u636E\\uFF0C\\u6700\\u5E38\\u89C1\\u7684\\u90FD\\u662F\\u4F7F\\u7528\\u6A21\\u8FD0\\u7B97\\u8FDB\\u884C\\u5408\\u5E76\\u3002Marsaglia \\u5728 Usenet \\u53D1\\u5E03\\u4E86 MWC1616 \\u4E4B\\u540E\\u4E5F\\u610F\\u8BC6\\u5230\\u4E86\\u8FD9\\u4E2A\\u95EE\\u9898\\uFF0C\\u6240\\u4EE5\\u5728 1999 \\u5E74 1 \\u6708 12 \\u65E5\\u53C8\\u53D1\\u5E03\\u4E86\\u5982\\u4ECA\\u88AB V8 \\u6240\\u6709\\u7684 MVC1616 \\u7248\\u672C\\u3002\\u516B\\u5929\\u4E4B\\u540E\\uFF0C\\u4ED6\\u53C8\\u53D1\\u8868\\u4E86\\u53E6\\u4E00\\u4E2A\\u4E0D\\u540C\\u7684\\u7248\\u672C\\u3002\\u65B0\\u7248\\u672C\\u5BF9\\u4E8E\\u4E24\\u4E2A\\u5B50\\u751F\\u6210\\u5668\\u7684\\u5408\\u5E76\\u66F4\\u52A0\\u5747\\u8861\\u3002\"}),(0,n.jsxs)(e.p,{children:[\"\\u8FD9\\u4E24\\u4E2A\\u7248\\u672C\\u7684 MWC1616 \\u90FD\\u88AB\\u5176\\u4ED6\\u7A0B\\u5E8F\\u5F15\\u7528\\u4E86\\uFF0C\\u6240\\u4EE5\\u5C31\\u51FA\\u73B0\\u4E86\\u8BEF\\u89E3\\u30021 \\u6708 20 \\u65E5\\u7684 MWC1616 \\u7684\\u57FA\\u6570\\u88AB\\u6807\\u8BB0\\u4E3A \",(0,n.jsx)(e.code,{children:\"b = 2^16\"}),\"\\uFF0C\\u4E14\\u88AB\\u6CE8\\u91CA\\u4E3A\\u4EC5\\u9650\\u7528\\u4E8E \",(0,n.jsx)(e.code,{children:\"32\"}),\" \\u4F4D\\u7684\\u7B97\\u672F\\u3002\\u5F53\\u4F60\\u4F7F\\u7528\\u8BE5\\u7248\\u672C\\u7684\\u65F6\\u5019\\uFF0C\\u4F1A\\u88AB\\u8B66\\u544A\\u66FF\\u6362\\u8BE5\\u7B97\\u6CD5\\uFF0C\\u4F46\\u5B9E\\u9645\\u4E0A\\u5B83\\u6BD4 V8 \",(0,n.jsx)(e.code,{children:\"Math.random()\"}),\" \\u4E2D\\u9002\\u7528\\u7684 MWC \\u8981\\u597D\\u3002\\u6B64\\u5916\\u66F4\\u4EE4\\u4EBA\\u4E0D\\u89E3\\u7684\\u662F\\uFF0C1 \\u6708 20 \\u65E5\\u7684 MWC1616 \\u88AB\\u7EF4\\u57FA\\u767E\\u79D1\\u4F5C\\u4E3A\\u968F\\u673A\\u6570\\u751F\\u6210\\u7684\\u793A\\u4F8B\\u6F14\\u793A\\uFF0C\\u800C TestU01 \\u4E2D\\u5305\\u542B\\u4E86\\u4E24\\u79CD 1 \\u6708 12 \\u65E5 MWC1616 \\u7684\\u5B9E\\u73B0\\uFF0C\\u4E00\\u4E2A\\u662F MWC1616\\uFF0C\\u4E00\\u4E2A\\u662F MWC97R\\u3002\"]}),(0,n.jsx)(e.p,{children:\"\\u5E0C\\u671B\\u8FD9\\u7BC7\\u6587\\u7AE0\\u53EF\\u4EE5\\u63D0\\u9192\\u5F00\\u53D1\\u8005\\uFF0C\\u5E76\\u5F3A\\u5316 Knuth \\u7684\\u89C2\\u5BDF\\u7ED3\\u679C\\uFF1A\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:\"\\u901A\\u5E38\\u6765\\u8BF4\\uFF0CPRNG \\u5B58\\u5728\\u7455\\u75B5\\uFF0C\\u5F00\\u53D1\\u8005\\u5E94\\u8BE5\\u5177\\u4F53\\u60C5\\u51B5\\u5177\\u4F53\\u5206\\u6790\\uFF0C\\u7406\\u89E3\\u8FD9\\u4E9B\\u7B97\\u6CD5\\u7684\\u5C40\\u9650\\u6027\"}),(0,n.jsx)(e.li,{children:\"\\u7279\\u522B\\u7684\\uFF0C\\u4E0D\\u8981\\u4F7F\\u7528 MWC1616\\uFF0C\\u5B83\\u5E76\\u4E0D\\u591F\\u597D\"})]}),(0,n.jsxs)(e.h2,{id:\"csprng\",children:[(0,n.jsx)(e.a,{href:\"#csprng\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"CSPRNG\"]}),(0,n.jsx)(e.p,{children:\"\\u4E3A\\u4E86\\u4FEE\\u590D\\u6211\\u4EEC\\u7684\\u6807\\u8BC6\\u7B26\\u751F\\u6210\\u5668\\uFF0C\\u9700\\u8981\\u4E00\\u79CD\\u89E3\\u6790\\u901F\\u5EA6\\u5FEB\\u3001\\u53EF\\u66FF\\u4EE3 Math.random() \\u7684\\u65B9\\u6CD5\\u3002\\u867D\\u7136\\u6709\\u5F88\\u591A JavaScript \\u7684 PRNG \\u5B9E\\u73B0\\u53EF\\u7528\\uFF0C\\u4F46\\u6211\\u4EEC\\u4E3B\\u8981\\u9488\\u5BF9\\u4EE5\\u4E0B\\u51E0\\u70B9\\u67E5\\u627E\\u8FD9\\u4E00\\u65B9\\u6CD5\\uFF1A\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsxs)(e.li,{children:[\"\\u5FAA\\u73AF\\u5468\\u671F\\u957F\\uFF0C\\u8FDC\\u5927\\u4E8E\\u6807\\u8BC6\\u7B26\\u7684 \",(0,n.jsx)(e.code,{children:\"2^132\"}),\" \\u79CD\\u53EF\\u80FD\\u6027\"]}),(0,n.jsx)(e.li,{children:\"\\u6709\\u826F\\u597D\\u7684\\u652F\\u6301\\u4E14\\u7ECF\\u5F97\\u8D77\\u6D4B\\u8BD5\"})]}),(0,n.jsxs)(e.p,{children:[\"\\u5E78\\u8FD0\\u7684\\u662F\\uFF0CNode.js \\u7684\\u6807\\u51C6\\u5E93\\u63D0\\u4F9B\\u4E86\\u53E6\\u4E00\\u4E2A PRNG \\u5C31\\u6EE1\\u8DB3\\u8FD9\\u4E24\\u70B9\\u8981\\u6C42\\uFF1A\",(0,n.jsx)(e.code,{children:\"crypto.randomBytes()\"}),\"\\uFF0C\\u4E00\\u4E2A\\u5BC6\\u7801\\u5B66\\u5B89\\u5168\\u4F2A\\u968F\\u673A\\u6570\\u751F\\u6210\\u5668\\uFF08CSPRNG\\uFF09\\u3002\\u5982\\u679C\\u662F\\u5728\\u6D4F\\u89C8\\u5668\\u4E0A\\uFF0C\\u4E5F\\u53EF\\u4EE5\\u4F7F\\u7528 \",(0,n.jsx)(e.code,{children:\"crypto.getRandomValues()\"}),\" \\u5B9E\\u73B0\\u3002\"]}),(0,n.jsx)(e.p,{children:\"\\u4F46\\u8FD9\\u5E76\\u4E0D\\u662F\\u5B8C\\u7F8E\\u7684\\u901A\\u7528\\u89E3\\u51B3\\u65B9\\u6848\\uFF0C\\u6709\\u4EE5\\u4E0B\\u4E09\\u4E2A\\u539F\\u56E0\\uFF1A\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:\"CSPRNG \\u901A\\u5E38\\u662F\\u975E\\u7EBF\\u6027\\u53D8\\u6362\\uFF0C\\u6162\\u4E8E\\u975E\\u5BC6\\u7801\\u7684\\u89E3\\u51B3\\u65B9\\u6848\"}),(0,n.jsx)(e.li,{children:\"\\u8BB8\\u591A CSPRNG \\u7CFB\\u7EDF\\u4E0D\\u652F\\u6301\\u79CD\\u5B50\\u72B6\\u6001\\uFF0C\\u8FDB\\u800C\\u4F7F\\u5F97\\u5E8F\\u5217\\u7ED3\\u679C\\u4E0D\\u53EF\\u590D\\u73B0\"}),(0,n.jsx)(e.li,{children:\"CSPRNG \\u5F3A\\u8C03\\u4E0D\\u53EF\\u9884\\u6D4B\\u6027\\u91CD\\u4E8E\\u8D28\\u91CF\"})]}),(0,n.jsx)(e.p,{children:\"\\u4E0D\\u8FC7\\uFF1A\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:\"\\u901F\\u5EA6\\u662F\\u76F8\\u5BF9\\u7684\\uFF0CCSPRNG \\u5BF9\\u5927\\u591A\\u6570\\u4F7F\\u7528\\u573A\\u666F\\u6765\\u8BF4\\u90FD\\u662F\\u5F88\\u5FEB\\u7684\"}),(0,n.jsx)(e.li,{children:\"\\u5BF9\\u4E8E\\u4E0D\\u53EF\\u9884\\u6D4B\\uFF0C\\u8FD9\\u4E5F\\u8BA9\\u6211\\u4EEC\\u65E0\\u6CD5\\u533A\\u5206\\u771F\\u6B63\\u7684\\u968F\\u673A\\u6027\\uFF0C\\u4E5F\\u5C31\\u662F\\u6211\\u4EEC\\u60F3\\u8981\\u7684\\u4F2A\\u968F\\u673A\\u6027\\u5E8F\\u5217\"}),(0,n.jsx)(e.li,{children:\"\\u4EE5\\u201C\\u5B89\\u5168\\u52A0\\u5BC6\\u201D\\u4E3A\\u4E3B\\u6253\\u7684\\u751F\\u6210\\u5668\\u5F80\\u5F80\\u4EE3\\u7801\\u5BA1\\u67E5\\u66F4\\u4E25\\u683C\\u4E14\\u968F\\u673A\\u6027\\u6D4B\\u8BD5\\u66F4\\u5168\\u9762\"})]}),(0,n.jsxs)(e.p,{children:[\"\\u5982\\u679C\\u4F60\\u65E0\\u6CD5\\u4FE1\\u4EFB\\u975E\\u52A0\\u5BC6\\u65B9\\u6848\\u7684\\u8D28\\u91CF\\uFF0C\\u6216\\u8005\\u9664\\u975E\\u4F7F\\u7528\\u65E2\\u5B9A\\u7684\\u6536\\u53D1\\u65B9\\u6848\\u4FDD\\u8BC1\\u8D28\\u91CF\\uFF0C\\u4F7F\\u7528 CSPRNG \\u90FD\\u662F\\u4F60\\u6700\\u597D\\u7684\\u9009\\u62E9\\u3002\\u5982\\u679C\\u4F60\\u4E0D\\u4FE1\\u4EFB\\u6807\\u51C6\\u5E93\\u4E2D\\u7684 CSPRNG\\uFF0C\\u90A3\\u4E48\\u53EF\\u4EE5\\u4F7F\\u7528\\u7531 kenel \\u7EF4\\u62A4\\u7684 \",(0,n.jsx)(e.a,{href:\"http://sockpuppet.org/blog/2014/02/25/safely-generate-random-numbers/\",children:\"urandom\"}),\"\\u3002\"]}),(0,n.jsxs)(e.p,{children:[\"\\u6211\\u65E0\\u6CD5\\u544A\\u8BC9\\u4F60 \",(0,n.jsx)(e.code,{children:\"crypto.randomBytes()\"}),\" \\u7684\\u786E\\u5207\\u5FAA\\u73AF\\u5468\\u671F\\uFF0C\\u662F\\u56E0\\u4E3A\\u8FD8\\u6CA1\\u4EBA\\u9047\\u5230\\u8FC7\\u8FD9\\u4E00\\u95EE\\u9898\\uFF0C\\u6211\\u53EA\\u80FD\\u8BF4\\u5B83\\u5F88\\u5B89\\u5168\\u3002\\u5982\\u679C\\u4F60\\u76F8\\u4FE1 OpenSSL \\u751F\\u6210\\u7684\\u516C\\u94A5\\u548C\\u79C1\\u94A5\\u7684\\u5B89\\u5168\\u6027\\uFF0C\\u90A3\\u4E48\\u5C31\\u6CA1\\u6709\\u7406\\u7531\\u4E0D\\u76F8\\u4FE1\\u5B83\\u3002\\u5728\\u5B9E\\u9645\\u5F00\\u53D1\\u4E2D\\uFF0C\\u4F7F\\u7528 \",(0,n.jsx)(e.code,{children:\"crypto.randomBytes()\"}),\" \\u53EF\\u4EE5\\u8F7B\\u677E\\u89E3\\u51B3 \",(0,n.jsx)(e.code,{children:\"Math.random()\"}),\" \\u7684\\u95EE\\u9898\\u3002\"]}),(0,n.jsxs)(e.p,{children:[\"\\u5B9E\\u9645\\u4E0A\\uFF0CChrome \\u4E5F\\u53EF\\u4EE5\\u4EE4 Math.random() \\u8C03\\u7528 crypto.randomBytes() \\u4E2D\\u4F7F\\u7528\\u7684 CSPRNG\\uFF0C\\u8BE6\\u89C1 \",(0,n.jsx)(e.a,{href:\"http://trac.webkit.org/browser/trunk/Source/WTF/wtf/RandomNumber.cpp#L41\",children:\"what Webkit is doing\"}),\"\\u3002\\u4E5F\\u5373\\u662F\\u8BF4\\uFF0C\\u6709\\u5F88\\u591A\\u5B89\\u5168\\u4E14\\u9AD8\\u8D28\\u91CF\\u7684\\u975E\\u52A0\\u5BC6\\u65B9\\u6848\\u3002\"]}),(0,n.jsxs)(e.h2,{id:\"v8s-prng\",children:[(0,n.jsx)(e.a,{href:\"#v8s-prng\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"V8's PRNG\"]}),(0,n.jsx)(e.p,{children:\"\\u6211\\u7684\\u76EE\\u6807\\u662F\\u8BF4\\u670D\\u4F60 V8 \\u7684 Math.random() \\u6709\\u7455\\u75B5\\u4E14\\u5E94\\u8BE5\\u88AB\\u66FF\\u6362\\u3002\\u5230\\u76EE\\u524D\\u4E3A\\u6B62\\u6211\\u4EEC\\u5DF2\\u7ECF\\u53D1\\u73B0\\u5B83\\u89C4\\u5F8B\\u6027\\u7684\\u8F93\\u51FA\\u3001\\u5728\\u6D4B\\u8BD5\\u4E0A\\u7684\\u5931\\u8D25\\u4EE5\\u53CA\\u771F\\u5B9E\\u73AF\\u5883\\u7684\\u4F4E\\u6027\\u80FD\\u7B49\\u95EE\\u9898\\u3002\\u5982\\u679C\\u4F60\\u671F\\u5F85\\u66F4\\u591A\\u7684\\u8BC1\\u636E\\uFF0C\\u90A3\\u5C31\\u770B\\u4EE5\\u4E0B\\u56FE\\u7247\\u5427\\uFF08\\u8BD1\\u8005\\u6CE8\\uFF1A\\u4EE5\\u4E0B\\u56FE\\u7247\\u6F14\\u793A\\u7684\\u95EE\\u9898\\u53EF\\u80FD\\u5DF2\\u88AB\\u4FEE\\u590D\\uFF09\\uFF1A\"}),(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{alt:\"V8's PRNG\",src:\"http://cdn2.w3cplus.com/cdn/farfuture/CcaG3IAyqC6mqWDZHZCj55rRvXRS176oIx-ix8o3vO0/mtime:1462030355/sites/default/files/blogs/2016/1604/20160428-math-random-csprng.png\"})}),(0,n.jsxs)(e.p,{children:[\"\\u6B64\\u65F6\\u4F60\\u5E94\\u8BE5\\u8BA4\\u53EF V8 \\u4E2D\\u7684 \",(0,n.jsx)(e.code,{children:\"Math.random()\"}),\" \\u5B58\\u5728\\u7F3A\\u9677\\u4E14\\u5E94\\u8BE5\\u88AB\\u4FEE\\u590D\\u4E86\\u5427\\u3002\\u90A3\\u4E48\\u95EE\\u9898\\u6765\\u4E86\\uFF0C\\u6211\\u4EEC\\u5E94\\u8BE5\\u5982\\u4F55\\u4FEE\\u590D\\u5B83\\u5462\\uFF1F\\u867D\\u7136\\u4FEE\\u590D\\u5F88\\u7B80\\u5355\\uFF0C\\u4F46\\u662F\\u7EE7\\u7EED\\u4F7F\\u7528 MWC \\u663E\\u7136\\u662F\\u65E0\\u610F\\u4E49\\u7684\\uFF0C\\u6211\\u4EEC\\u6709\\u66F4\\u597D\\u7684\\u9009\\u62E9\\u3002\"]}),(0,n.jsx)(e.p,{children:\"\\u4E0B\\u9762\\u5217\\u51FA\\u4E86\\u6211\\u4EEC\\u5BF9\\u968F\\u673A\\u6570\\u751F\\u6210\\u5668\\u7684\\u8981\\u6C42\\uFF1A\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsxs)(e.li,{children:[\"\\u968F\\u673A\\u6570\\u7A7A\\u95F4\\u5927\\uFF0C\\u79CD\\u5B50\\u72B6\\u6001\\u591A\\u2014\\u2014\\u7406\\u60F3\\u60C5\\u51B5\\u4E0B\\uFF0C\\u8981\\u5927\\u4E8E \",(0,n.jsx)(e.code,{children:\"1024\"}),\" \\u4F4D\\uFF0C\\u56E0\\u4E3A\\u8FD9\\u662F\\u5176\\u4ED6\\u751F\\u6210\\u5668\\u4FDD\\u8BC1\\u8D28\\u91CF\\u7684\\u4E0A\\u9650\\u3002\\u5BF9\\u4E8E \",(0,n.jsx)(e.code,{children:\"2^1024\"}),\" \\u79CD\\u53EF\\u80FD\\u6027\\uFF0C\\u8DB3\\u4EE5\\u6EE1\\u8DB3 99.9% \\u7684\\u9700\\u6C42\\u4E86\\uFF0C\\u4E14\\u5177\\u6709\\u5F3A\\u5927\\u7684\\u5B89\\u5168\\u6027\"]}),(0,n.jsx)(e.li,{children:\"\\u901F\\u5EA6\\u81F3\\u5C11\\u8981\\u548C\\u5F53\\u524D\\u7684\\u5B9E\\u73B0\\u4FDD\\u6301\\u4E00\\u81F4\"}),(0,n.jsx)(e.li,{children:\"\\u9AD8\\u6548\\u7684\\u5185\\u5B58\\u4F7F\\u7528\\u7387\"}),(0,n.jsxs)(e.li,{children:[\"\\u5FAA\\u73AF\\u5468\\u671F\\u836F\\u5382\\uFF0C\\u4EFB\\u4F55\\u5927\\u4E8E \",(0,n.jsx)(e.code,{children:\"2^50\"}),\" \\u5468\\u671F\\u957F\\u5EA6\\u7684\\u751F\\u6210\\u5668\\u90FD\\u662F\\u53EF\\u7528\\u7684\\uFF0C\\u5927\\u4E8E \",(0,n.jsx)(e.code,{children:\"2^100\"}),\" \\u5219\\u53EF\\u8BA9\\u4F2A\\u968F\\u673A\\u6027\\u4EE5\\u5047\\u4E71\\u771F\"]}),(0,n.jsx)(e.li,{children:\"\\u7ECF\\u5F97\\u8D77\\u968F\\u673A\\u6027\\u6D4B\\u8BD5\"})]}),(0,n.jsxs)(e.p,{children:[\"\\u5F53\\u524D\\u6709\\u8BB8\\u591A PRNG \\u7B97\\u6CD5\\u6EE1\\u8DB3\\u6216\\u8FDC\\u8D85\\u4E0A\\u8FF0\\u8981\\u6C42\\u3002\",(0,n.jsx)(e.a,{href:\"https://en.wikipedia.org/wiki/Xorshift\",children:\"Xorshift\"}),\" \\u901F\\u5EA6\\u5FEB\\u4E14\\u8010\\u5F97\\u4F4F\\u4E25\\u683C\\u7684\\u7EDF\\u8BA1\\u6D4B\\u8BD5\\u3002xorgens4096 \\u662F xorshift \\u7684\\u53D8\\u4F53\\uFF0C\\u57FA\\u4E8E JavaScript \\u5F00\\u53D1\\u5B9E\\u73B0\\uFF0C\\u5B83\\u6709 4096 \\u4F4D\\u72B6\\u6001\\u7A7A\\u95F4\\uFF0C\\u5FAA\\u73AF\\u5468\\u671F\\u957F\\u8FBE 2^4096\\uFF0C\\u5E76\\u4E14\\u6BD4 Chrome \\u4E2D\\u7684 MWC16 \\u8FD0\\u884C\\u901F\\u5EA6\\u66F4\\u5FEB\\u3002\\u6B64\\u5916\\uFF0C\\u5B83\\u80FD\\u591F\\u65E0\\u7CFB\\u7EDF\\u6545\\u969C\\u5730\\u901A\\u8FC7 BigCrush \\u7684\\u6D4B\\u8BD5\\u3002\"]}),(0,n.jsxs)(e.p,{children:[\"\\u6700\\u8FD1\\u7684\\u5B9E\\u8DF5\\u8868\\u660E\\uFF0C\\u4F7F\\u7528 xorshift \\u751F\\u6210\\u7684\\u7ED3\\u679C\\u4E58\\u4EE5\\u5E38\\u91CF\\u7684\\u7ED3\\u679C\\u4E5F\\u53EF\\u4EE5\\u901A\\u8FC7 BigCrush \\u5BF9\\u975E\\u7EBF\\u6027\\u8F6C\\u6362\\u751F\\u6210\\u5668\\u7684\\u6D4B\\u8BD5\\u3002\\u6B64\\u7C7B\\u751F\\u6210\\u5668\\u88AB\\u79F0\\u4E3A \",(0,n.jsx)(e.code,{children:\"xorshift\\\\*\"}),\"\\uFF0C\\u5B83\\u4EEC\\u89E3\\u6790\\u901F\\u5EA6\\u5FEB\\u3001\\u6613\\u4E8E\\u65F6\\u95F4\\u4E14\\u5185\\u5B58\\u4F7F\\u7528\\u6548\\u7387\\u9AD8\\uFF0C\\u5176\\u4E2D \",(0,n.jsx)(e.code,{children:\"xorshift102\\\\*\"}),\"\\u5C31\\u6EE1\\u8DB3\\u751A\\u81F3\\u8D85\\u8FC7\\u4EE5\\u4E0A\\u7684\\u5168\\u90E8\\u8981\\u6C42\\u3002\\u5982\\u679C\\u5185\\u5B58\\u5360\\u7528\\u95EE\\u9898\\u4E25\\u91CD\\uFF0C\\u4E5F\\u53EF\\u4EE5\\u4F7F\\u7528 \",(0,n.jsx)(e.code,{children:\"xorshift64\\\\*\"}),\"\\uFF0C\\u5B83\\u6BD4 MWC1616 \\u7684\\u5185\\u5B58\\u5360\\u7528\\u7387\\u76F8\\u540C\\uFF0C\\u4F46\\u5FAA\\u73AF\\u5468\\u671F\\u66F4\\u957F\\u3001\\u89E3\\u6790\\u66F4\\u5FEB\\u3002\\u53E6\\u4E00\\u4E2A\\u7EBF\\u6027\\u548C\\u975E\\u7EBF\\u6027\\u7684\\u6DF7\\u5408\\u751F\\u6210\\u5668\\u662F PCG\\uFF0C\\u5B83\\u58F0\\u79F0\\u5177\\u6709\\u548C \",(0,n.jsx)(e.code,{children:\"xorshift\\\\*\"}),\" \\u5177\\u6709\\u76F8\\u4F3C\\u7684\\u6027\\u80FD\\u548C\\u8D28\\u91CF\\u3002\"]}),(0,n.jsxs)(e.p,{children:[\"\\u6240\\u4EE5\\u8BF4\\u6211\\u4EEC\\u6709\\u8BB8\\u591A\\u53EF\\u9009\\u62E9\\u7684\\u7B97\\u6CD5\\uFF0C\\u5176\\u4E2D\\uFF0C\\u6700\\u5B89\\u5168\\u7684\\u9009\\u62E9\\u4E5F\\u8BB8\\u5C31\\u662F\\u6807\\u51C6\\u7684 Mersenne Twiste\\uFF08\\u9A6C\\u7279\\u8D5B\\u7279\\u65CB\\u8F6C\\u6F14\\u7B97\\u6CD5\\uFF09\\u3002\\u8BE5\\u7B97\\u6CD5\\u6700\\u53D7\\u6B22\\u8FCE\\u7684\\u53D8\\u4F53 MT19937 \\u8BDE\\u751F\\u4E8E\\u4E5D\\u5341\\u5E74\\u4EE3\\u672B\\uFF0C\\u4ECE\\u90A3\\u65F6\\u5F00\\u59CB\\u5B83\\u5C31\\u6210\\u4E3A\\u4E86\\u8BB8\\u591A\\u8F6F\\u4EF6\\u6807\\u51C6\\u7684\\u968F\\u673A\\u6570\\u751F\\u6210\\u7B56\\u7565\\u3002\\u5B83\\u5E76\\u4E0D\\u662F\\u5B8C\\u7F8E\\u7684\\uFF0C\\u4F46\\u4E45\\u7ECF\\u8003\\u9A8C\\u548C\\u5206\\u6790\\uFF0C\\u4E14\\u6613\\u4E8E\\u7406\\u89E3\\u3002\\u503C\\u5F97\\u70AB\\u8000\\u7684\\u662F\\uFF0C\\u5B83\\u7684\\u5FAA\\u73AF\\u5468\\u671F\\u957F\\u8FBE \",(0,n.jsx)(e.code,{children:\"2^19937-1\"}),\"\\uFF0C\\u57FA\\u672C\\u4E0A\\u4E0D\\u4F1A\\u53D1\\u751F\\u78B0\\u649E\\uFF0C\\u4F46\\u4F7F\\u7528\\u8BE5\\u7B97\\u6CD5\\u4F1A\\u5F3A\\u5236\\u8981\\u6C42 2KB \\u7684\\u72B6\\u6001\\u7A7A\\u95F4\\u548C\\u76F8\\u5E94\\u7684\\u5185\\u5B58\\u5360\\u7528\\u3001\\u6027\\u80FD\\u6D88\\u8017\\u3002\\u867D\\u7136\\u65E0\\u6CD5\\u89E3\\u91CA\\uFF0C\\u4F46\\u5B83\\u548C Chrome \\u4E2D \",(0,n.jsx)(e.code,{children:\"Math.random()\"}),\" \\u7684\\u6267\\u884C\\u901F\\u5EA6\\u4E00\\u6837\\u5FEB\\u3002\"]}),(0,n.jsxs)(e.p,{children:[\"\\u6240\\u4EE5\\u6211\\u7684\\u5EFA\\u8BAE\\u5C31\\u662F V8 \\u5E94\\u8BE5\\u8003\\u8651\\u4E00\\u4E0B Dean McNamee \\u516D\\u5E74\\u524D\\u7684\\u5EFA\\u8BAE\\uFF0C\\u4F7F\\u7528\\u9A6C\\u7279\\u8D5B\\u7279\\u65CB\\u8F6C\\u6F14\\u7B97\\u6CD5\\u5B9E\\u73B0 \",(0,n.jsx)(e.code,{children:\"Math.random()\"}),\" \\u4E86\\u3002\\u5B83\\u89E3\\u6790\\u901F\\u5EA6\\u5FEB\\u3001\\u5065\\u58EE\\u4E14\\u5B89\\u5168\\uFF0C\\u5BF9\\u4E0D\\u4E86\\u89E3 PRNG \\u8FD0\\u884C\\u673A\\u5236\\u7684\\u5F00\\u53D1\\u8005\\u4E5F\\u662F\\u5B89\\u5168\\u65E0\\u5BB3\\u7684\\u3002\\u5F53\\u7136\\u4E5F\\u53EF\\u4EE5\\u9009\\u62E9\\u5176\\u4ED6\\u65B9\\u6848\\uFF0C\\u4F46\\u8BF7\\u4E0D\\u8981\\u518D\\u4F7F\\u7528 MWC1616 \\u4E86\\uFF01\"]}),(0,n.jsxs)(e.h2,{id:\"\\u603B\\u7ED3\",children:[(0,n.jsx)(e.a,{href:\"#\\u603B\\u7ED3\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u603B\\u7ED3\"]}),(0,n.jsx)(e.p,{children:\"\\u672C\\u6587\\u4E5F\\u662F\\u591F\\u957F\\u7684\\uFF0C\\u6211\\u4EEC\\u603B\\u7ED3\\u4E00\\u4E0B\\uFF1A\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsxs)(e.li,{children:[\"V8 \\u4E2D\\u7684 \",(0,n.jsx)(e.code,{children:\"Math.random()\"}),\" \\u4F7F\\u7528\\u7684 PRNG \\u7B97\\u6CD5\\u662F MWC1616\\u3002\\u5982\\u679C\\u4F60\\u53EA\\u4F7F\\u7528 \",(0,n.jsx)(e.code,{children:\"16\"}),\" \\u4F4D\\uFF0C\\u90A3\\u4E48\\u5B83\\u7684\\u5FAA\\u73AF\\u5468\\u671F\\u957F\\u5EA6\\u5C31\\u4F1A\\u5F88\\u77ED\\u3002\\u901A\\u5E38\\u6765\\u8BF4\\uFF0C\\u5B83\\u5728\\u8D28\\u91CF\\u6D4B\\u8BD5\\u4E2D\\u7684\\u8868\\u73B0\\u5F88\\u5DEE\\uFF0C\\u5BF9\\u4E8E\\u5927\\u591A\\u6570\\u7684\\u91CD\\u8981\\u573A\\u666F\\uFF0C\\u5B83\\u6240\\u4F2A\\u9020\\u7684\\u968F\\u673A\\u6027\\u662F\\u4E0D\\u5B89\\u5168\\u7684\\u3002\"]}),(0,n.jsxs)(e.li,{children:[\"\\u5982\\u679C\\u4F60\\u6CA1\\u65F6\\u95F4\\u5B9E\\u73B0\\u975E\\u52A0\\u5BC6\\u7684\\u65B9\\u6848\\uFF0C\\u90A3\\u5C31\\u76F4\\u63A5\\u4F7F\\u7528 CSPRNG \\u5427\\u3002\\u6700\\u5B89\\u5168\\u7684\\u7684\\u65B9\\u5F0F\\u5C31\\u662F\\u4F7F\\u7528 \",(0,n.jsx)(e.a,{href:\"http://sockpuppet.org/blog/2014/02/25/safely-generate-random-numbers/\",children:\"urandom\"}),\"\\u3002\\u5728\\u6D4F\\u89C8\\u5668\\u73AF\\u5883\\u4E2D\\uFF0C\\u53EF\\u4EE5\\u4F7F\\u7528 \",(0,n.jsx)(e.code,{children:\"crypto.getRandomValues()\"}),\"\\u3002\"]}),(0,n.jsxs)(e.li,{children:[\"\\u4E5F\\u6709\\u8BB8\\u591A\\u6BD4 MWC1616 \\u901F\\u5EA6\\u66F4\\u5FEB\\u3001\\u8D28\\u91CF\\u66F4\\u9AD8\\u7684\\u975E\\u52A0\\u5BC6 PRNG \\u7B97\\u6CD5\\u3002V8 \\u5E94\\u8BE5\\u4F7F\\u7528\\u5B83\\u4EEC\\u91CD\\u65B0\\u5B9E\\u73B0 \",(0,n.jsx)(e.code,{children:\"Math.random()\"}),\"\\u3002Mersenne Twiste \\u53EF\\u4EE5\\u8BF4\\u662F\\u6700\\u53D7\\u6B22\\u8FCE\\u7684\\u65B9\\u6848\\u4E86\\uFF0C\\u6709\\u53EF\\u80FD\\u4E5F\\u662F\\u6700\\u5B89\\u5168\\u7684\\u65B9\\u6848\\u3002\"]})]}),(0,n.jsx)(e.p,{children:\"\\u6CE8\\u610F\\uFF0CMozilla \\u4E2D\\u4F7F\\u7528\\u4E86\\u6765\\u81EA Java \\u7684 util.Random \\u5305\\uFF0C\\u4E14\\u7565\\u5DEE\\u4E8E MWC1616\\uFF0C\\u6240\\u4EE5 SpiderMonkey \\u4E5F\\u5E94\\u8BE5\\u5347\\u7EA7\\u76F8\\u5173\\u65B9\\u6CD5\\u3002\"}),(0,n.jsxs)(e.h3,{id:\"\\u53C2\\u8003\\u8D44\\u6599\",children:[(0,n.jsx)(e.a,{href:\"#\\u53C2\\u8003\\u8D44\\u6599\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"\\u53C2\\u8003\\u8D44\\u6599\"]}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"http://digitalcommons.wayne.edu/cgi/viewcontent.cgi?article=1725\u0026context=jmasm\",children:\"Random Number Generators\"})}),(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"https://en.wikipedia.org/wiki/Multiply-with-carry#General_theory\",children:\"Multiply-with-carry\"})}),(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"http://xorshift.di.unimi.it/\",children:\":::xoroshiro+ / xorshift* / xorshift+ generators and the PRNG shootout\"})}),(0,n.jsx)(e.li,{children:(0,n.jsx)(e.a,{href:\"http://www.mathpages.com/home/kmath580/kmath580.htm\",children:\"Probability of Intersecting Intervals\"})})]}),(0,n.jsxs)(e.blockquote,{children:[(0,n.jsxs)(e.p,{children:[\"\\u672C\\u6587\\u6839\\u636E\",(0,n.jsx)(e.a,{href:\"https://medium.com/@betable\",children:\"@Betable Engineering\"}),\"\\u7684\\u300A\",(0,n.jsx)(e.a,{href:\"https://medium.com/@betable/tifu-by-using-math-random-f1c308c4fd9d#.si669u680\",children:\"TIFU by using Math.random()\"}),\"\\u300B\\u6240\\u8BD1\\uFF0C\\u6574\\u4E2A\\u8BD1\\u6587\\u5E26\\u6709\\u6211\\u4EEC\\u81EA\\u5DF1\\u7684\\u7406\\u89E3\\u4E0E\\u601D\\u60F3\\uFF0C\\u5982\\u679C\\u8BD1\\u5F97\\u4E0D\\u597D\\u6216\\u6709\\u4E0D\\u5BF9\\u4E4B\\u5904\\u8FD8\\u8BF7\\u540C\\u884C\\u670B\\u53CB\\u6307\\u70B9\\u3002\\u5982\\u9700\\u8F6C\\u8F7D\\u6B64\\u8BD1\\u6587\\uFF0C\\u9700\\u6CE8\\u660E\\u82F1\\u6587\\u51FA\\u5904\\uFF1A\",(0,n.jsx)(e.a,{href:\"https://medium.com/@betable/tifu-by-using-math-random-f1c308c4fd9d#.si669u680\",children:\"https://medium.com/@betable/tifu-by-using-math-random-f1c308c4fd9d#.si669u680\"}),\"\\u3002\"]}),(0,n.jsxs)(e.p,{children:[\"\\u539F\\u6587\\u51FA\\u5904\\uFF1A\",(0,n.jsx)(e.a,{href:\"http://www.w3cplus.com/javascript/tifu-by-using-math-random.html\",children:\"http://www.w3cplus.com/javascript/tifu-by-using-math-random.html\"})]})]})]})}}var y=w;return g(M);})();\n;return Component;","toc":[{"value":"PRNG","url":"#prng","depth":2},{"value":"Math.random()","url":"#mathrandom","depth":2},{"value":"V8 PRNG","url":"#v8-prng","depth":2},{"value":"双子生成器","url":"#双子生成器","depth":2},{"value":"MWC1616","url":"#mwc1616","depth":2},{"value":"CSPRNG","url":"#csprng","depth":2},{"value":"V8's PRNG","url":"#v8s-prng","depth":2},{"value":"总结","url":"#总结","depth":2},{"value":"参考资料","url":"#参考资料","depth":3}],"frontMatter":{"authors":null,"readingTime":{"text":"5 min read","minutes":4.84,"time":290400,"words":968},"slug":"math-random","fileName":"math-random.md","locale":"zh","title":"Math.random()","date_published":"2016-05-02T14:42:54.000Z","date_updated":"2018-03-10T01:01:17.000Z","author":"Jeffey Wang","tags":["Node.js"],"summary":"唐纳德·克努特曾在《计算机程序设计的艺术》（卷二）中指出：“当今使用的大部分随机数生成器都不够优秀，而且开发者倾向于拿来就用，不去了解具体的生成策略。以至于我们常常发现一些略有瑕疵、年代久远的随机数生成器会被盲目地用在一个又一个的程序中，而对于它们的局限性，却无人问津。”"}},"authorDetails":[{"authors":null,"readingTime":{"text":"1 min read","minutes":0.335,"time":20100,"words":67},"slug":"default","fileName":"default.md","locale":"zh","name":"Jeffrey Wang","avatar":"//static/images/avatar.jpg","occupation":"前端开发工程师","company":"深圳大学","email":"546323405@qq.com","github":"https://github.com/armyja","sinaWeibo":"sinaweibo://userinfo?uid=1770048285"}],"prev":{"title":"Node.js：exports 与 module.exports 的区别","summary":"","tags":["Node.js"],"slug":"nodejszhong-exportsyu-module-exportsde-qu-bie-xiang-xi-jie-shao","date_published":"2016-04-20T03:35:49.000Z","date_updated":"2016-04-20T06:09:44.000Z","draft":false,"author":"Jeffey Wang","locale":"zh"},"next":{"title":"动态追踪技术漫谈","summary":"动态追踪技术其实是一种后现代的高级调试技术。它可以帮助软件工程师以非常低的成本，在非常短的时间内，回答一些很难的关于软件系统方面的问题，从而更快速地排查和解决问题。","tags":["Knowledge"],"slug":"dynamic-tracing","date_published":"2016-05-11T05:08:02.000Z","date_updated":"2018-03-10T01:00:50.000Z","draft":false,"author":"Jeffey Wang","locale":"zh"},"otherLocales":[],"_nextI18Next":{"initialI18nStore":{"zh":{"common":{"tags":"标签","about":"关于"},"post":{"previous-article":"上一篇文章","next-article":"下一篇文章","view-on-github":"在 GitHub 查看","back":"返回"}}},"initialLocale":"zh","userConfig":{"i18n":{"locales":["zh","en"],"defaultLocale":"zh"},"default":{"i18n":{"locales":["zh","en"],"defaultLocale":"zh"}}}}},"__N_SSG":true},"page":"/[locale]/blog/[...slug]","query":{"locale":"zh","slug":["math-random"]},"buildId":"ttnszolnmKQYjpK0XVIq0","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>